<!DOCTYPE html>
<html>
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8">
  

  
  <title>网络协议 | Game 2020</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="维基百科1">
<meta property="og:type" content="article">
<meta property="og:title" content="网络协议">
<meta property="og:url" content="https://2020.iosdevlog.com/2020/04/13/network/index.html">
<meta property="og:site_name" content="Game 2020">
<meta property="og:description" content="维基百科1">
<meta property="og:image" content="https://2020.iosdevlog.com/2020/04/13/network/Communication_protocol.png">
<meta property="og:image" content="https://2020.iosdevlog.com/2020/04/13/network/0.png">
<meta property="og:image" content="https://2020.iosdevlog.com/2020/04/13/network/1.png">
<meta property="og:image" content="https://2020.iosdevlog.com/2020/04/13/network/2.jpg">
<meta property="og:image" content="https://2020.iosdevlog.com/2020/04/13/network/3.jpg">
<meta property="og:image" content="https://2020.iosdevlog.com/2020/04/13/network/4.jpg">
<meta property="og:image" content="https://2020.iosdevlog.com/2020/04/13/network/5.png">
<meta property="og:image" content="https://2020.iosdevlog.com/2020/04/13/network/6.jpg">
<meta property="og:image" content="https://2020.iosdevlog.com/2020/04/13/network/7.jpg">
<meta property="og:image" content="https://2020.iosdevlog.com/2020/04/13/network/8.jpg">
<meta property="og:image" content="https://2020.iosdevlog.com/2020/04/13/network/9.jpg">
<meta property="og:image" content="https://2020.iosdevlog.com/2020/04/13/network/10.jpg">
<meta property="og:image" content="https://2020.iosdevlog.com/2020/04/13/network/11.jpg">
<meta property="og:image" content="https://2020.iosdevlog.com/2020/04/13/network/12.jpg">
<meta property="og:image" content="https://2020.iosdevlog.com/2020/04/13/network/13.jpg">
<meta property="og:image" content="https://2020.iosdevlog.com/2020/04/13/network/14.jpg">
<meta property="og:image" content="https://2020.iosdevlog.com/2020/04/13/network/15.jpg">
<meta property="og:image" content="https://2020.iosdevlog.com/2020/04/13/network/16.jpg">
<meta property="og:image" content="https://2020.iosdevlog.com/2020/04/13/network/17.jpg">
<meta property="og:image" content="https://2020.iosdevlog.com/2020/04/13/network/18.jpg">
<meta property="og:image" content="https://2020.iosdevlog.com/2020/04/13/network/19.jpg">
<meta property="og:image" content="https://2020.iosdevlog.com/2020/04/13/network/20.jpg">
<meta property="og:image" content="https://2020.iosdevlog.com/2020/04/13/network/21.jpg">
<meta property="og:image" content="https://2020.iosdevlog.com/2020/04/13/network/22.jpg">
<meta property="og:image" content="https://2020.iosdevlog.com/2020/04/13/network/23.jpg">
<meta property="og:image" content="https://2020.iosdevlog.com/2020/04/13/network/24.jpg">
<meta property="og:image" content="https://2020.iosdevlog.com/2020/04/13/network/25.jpg">
<meta property="og:image" content="https://2020.iosdevlog.com/2020/04/13/network/25.jpg">
<meta property="og:image" content="https://2020.iosdevlog.com/2020/04/13/network/27.jpg">
<meta property="og:image" content="https://2020.iosdevlog.com/2020/04/13/network/28.jpg">
<meta property="og:image" content="https://2020.iosdevlog.com/2020/04/13/network/29.jpg">
<meta property="og:image" content="https://2020.iosdevlog.com/2020/04/13/network/30.jpg">
<meta property="og:image" content="https://2020.iosdevlog.com/2020/04/13/network/31.jpg">
<meta property="og:image" content="https://2020.iosdevlog.com/2020/04/13/network/32.jpg">
<meta property="og:image" content="https://2020.iosdevlog.com/2020/04/13/network/33.jpg">
<meta property="og:image" content="https://2020.iosdevlog.com/2020/04/13/network/34.jpg">
<meta property="og:image" content="https://2020.iosdevlog.com/2020/04/13/network/35.jpg">
<meta property="og:image" content="https://2020.iosdevlog.com/2020/04/13/network/36.jpg">
<meta property="og:image" content="https://2020.iosdevlog.com/2020/04/13/network/37.jpg">
<meta property="og:image" content="https://2020.iosdevlog.com/2020/04/13/network/38.jpg">
<meta property="og:image" content="https://2020.iosdevlog.com/2020/04/13/network/39.jpg">
<meta property="og:image" content="https://2020.iosdevlog.com/2020/04/13/network/40.jpg">
<meta property="og:image" content="https://2020.iosdevlog.com/2020/04/13/network/41.jpg">
<meta property="og:image" content="https://2020.iosdevlog.com/2020/04/13/network/42.jpg">
<meta property="og:image" content="https://2020.iosdevlog.com/2020/04/13/network/43.jpg">
<meta property="og:image" content="https://2020.iosdevlog.com/2020/04/13/network/44.jpg">
<meta property="og:image" content="https://2020.iosdevlog.com/2020/04/13/network/45.jpg">
<meta property="og:image" content="https://2020.iosdevlog.com/2020/04/13/network/46.jpg">
<meta property="og:image" content="https://2020.iosdevlog.com/2020/04/13/network/47.jpg">
<meta property="og:image" content="https://2020.iosdevlog.com/2020/04/13/network/48.jpg">
<meta property="og:image" content="https://2020.iosdevlog.com/2020/04/13/network/49.jpg">
<meta property="og:image" content="https://2020.iosdevlog.com/2020/04/13/network/50.jpg">
<meta property="og:image" content="https://2020.iosdevlog.com/2020/04/13/network/51.jpg">
<meta property="og:image" content="https://2020.iosdevlog.com/2020/04/13/network/52.jpg">
<meta property="og:image" content="https://2020.iosdevlog.com/2020/04/13/network/53.jpg">
<meta property="og:image" content="https://2020.iosdevlog.com/2020/04/13/network/54.jpg">
<meta property="og:image" content="https://2020.iosdevlog.com/2020/04/13/network/55.jpg">
<meta property="og:image" content="https://2020.iosdevlog.com/2020/04/13/network/56.jpg">
<meta property="og:image" content="https://2020.iosdevlog.com/2020/04/13/network/57.jpg">
<meta property="og:image" content="https://2020.iosdevlog.com/2020/04/13/network/58.jpg">
<meta property="og:image" content="https://2020.iosdevlog.com/2020/04/13/network/59.jpg">
<meta property="og:image" content="https://2020.iosdevlog.com/2020/04/13/network/60.jpg">
<meta property="og:image" content="https://2020.iosdevlog.com/2020/04/13/network/61.jpg">
<meta property="og:image" content="https://2020.iosdevlog.com/2020/04/13/network/62.jpg">
<meta property="og:image" content="https://2020.iosdevlog.com/2020/04/13/network/63.jpg">
<meta property="og:image" content="https://2020.iosdevlog.com/2020/04/13/network/64.jpg">
<meta property="og:image" content="https://2020.iosdevlog.com/2020/04/13/network/65.jpg">
<meta property="og:image" content="https://2020.iosdevlog.com/2020/04/13/network/66.jpg">
<meta property="og:image" content="https://2020.iosdevlog.com/2020/04/13/network/67.jpg">
<meta property="og:image" content="https://2020.iosdevlog.com/2020/04/13/network/68.jpg">
<meta property="og:image" content="https://2020.iosdevlog.com/2020/04/13/network/69.jpg">
<meta property="og:image" content="https://2020.iosdevlog.com/2020/04/13/network/70.jpg">
<meta property="og:image" content="https://2020.iosdevlog.com/2020/04/13/network/71.jpg">
<meta property="og:image" content="https://2020.iosdevlog.com/2020/04/13/network/72.jpg">
<meta property="og:image" content="https://2020.iosdevlog.com/2020/04/13/network/73.jpg">
<meta property="og:image" content="https://2020.iosdevlog.com/2020/04/13/network/74.jpg">
<meta property="og:image" content="https://2020.iosdevlog.com/2020/04/13/network/75.jpg">
<meta property="og:image" content="https://2020.iosdevlog.com/2020/04/13/network/76.jpg">
<meta property="og:image" content="https://2020.iosdevlog.com/2020/04/13/network/77.jpg">
<meta property="og:image" content="https://2020.iosdevlog.com/2020/04/13/network/78.jpg">
<meta property="og:image" content="https://2020.iosdevlog.com/2020/04/13/network/79.jpg">
<meta property="og:image" content="https://2020.iosdevlog.com/2020/04/13/network/80.jpg">
<meta property="og:image" content="https://2020.iosdevlog.com/2020/04/13/network/81.jpg">
<meta property="og:image" content="https://2020.iosdevlog.com/2020/04/13/network/82.jpg">
<meta property="og:image" content="https://2020.iosdevlog.com/2020/04/13/network/83.jpg">
<meta property="og:image" content="https://2020.iosdevlog.com/2020/04/13/network/84.jpg">
<meta property="og:image" content="https://2020.iosdevlog.com/2020/04/13/network/85.jpg">
<meta property="article:published_time" content="2020-04-12T16:27:21.000Z">
<meta property="article:modified_time" content="2020-04-14T17:04:41.230Z">
<meta property="article:author" content="iOSDevLog">
<meta property="article:tag" content="network">
<meta property="article:tag" content="protocal">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://2020.iosdevlog.com/2020/04/13/network/Communication_protocol.png">
  
    <link rel="alternate" href="/atom.xml" title="Game 2020" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 4.2.0"><!-- hexo-inject:begin --><!-- hexo-inject:end --></head>

<body>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Game 2020</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">https://2020.iosdevlog.com</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/2020">2020 Calendar</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://2020.iosdevlog.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-network" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/04/13/network/" class="article-date">
  <time datetime="2020-04-12T16:27:21.000Z" itemprop="datePublished">2020-04-13</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/geek/">geek</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      网络协议
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><img src="https://2020.iosdevlog.com/2020/04/13/network/Communication_protocol.png" /></p>
<p>维基百科<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<a id="more"></a>
<p><a href="https://zh.wikipedia.org/wiki/TCP/IP%E5%8D%8F%E8%AE%AE%E6%97%8F" target="_blank" rel="noopener" title="TCP/IP协议族">网际网路协议套组</a></p>
<p><a href="https://zh.wikipedia.org/wiki/%E5%BA%94%E7%94%A8%E5%B1%82" target="_blank" rel="noopener" title="应用层">应用层</a></p>
<ul>
<li><a href="https://zh.wikipedia.org/wiki/Border_Gateway_Protocol" target="_blank" rel="noopener" title="Border Gateway Protocol">BGP</a></li>
<li><a href="https://zh.wikipedia.org/wiki/Dynamic_Host_Configuration_Protocol" target="_blank" rel="noopener" title="Dynamic Host Configuration Protocol">DHCP</a></li>
<li><a href="https://zh.wikipedia.org/wiki/Domain_Name_System" target="_blank" rel="noopener" title="Domain Name System">DNS</a></li>
<li><a href="https://zh.wikipedia.org/wiki/%E6%AA%94%E6%A1%88%E5%82%B3%E8%BC%B8%E5%8D%94%E5%AE%9A" target="_blank" rel="noopener" title="档案传输协定">FTP</a></li>
<li><a href="https://zh.wikipedia.org/wiki/%E8%B6%85%E6%96%87%E6%9C%AC%E4%BC%A0%E8%BE%93%E5%8D%8F%E8%AE%AE" target="_blank" rel="noopener" title="超文本传输协议">HTTP</a></li>
<li><a href="https://zh.wikipedia.org/wiki/HTTPS" target="_blank" rel="noopener" title="HTTPS">HTTPS</a></li>
<li><a href="https://zh.wikipedia.org/wiki/Internet_Message_Access_Protocol" target="_blank" rel="noopener" title="Internet Message Access Protocol">IMAP</a></li>
<li><a href="https://zh.wikipedia.org/wiki/Lightweight_Directory_Access_Protocol" target="_blank" rel="noopener" title="Lightweight Directory Access Protocol">LDAP</a></li>
<li><a href="https://zh.wikipedia.org/w/index.php?title=%E5%AA%92%E9%AB%94%E9%96%98%E9%81%93%E6%8E%A7%E5%88%B6%E5%8D%94%E5%AE%9A&amp;action=edit&amp;redlink=1" target="_blank" rel="noopener">MGCP</a></li>
<li><a href="https://zh.wikipedia.org/wiki/MQTT" target="_blank" rel="noopener" title="MQTT">MQTT</a></li>
<li><a href="https://zh.wikipedia.org/wiki/Network_News_Transfer_Protocol" target="_blank" rel="noopener" title="Network News Transfer Protocol">NNTP</a></li>
<li><a href="https://zh.wikipedia.org/wiki/Network_Time_Protocol" target="_blank" rel="noopener" title="Network Time Protocol">NTP</a></li>
<li><a href="https://zh.wikipedia.org/wiki/Post_Office_Protocol" target="_blank" rel="noopener" title="Post Office Protocol">POP</a></li>
<li><a href="https://zh.wikipedia.org/wiki/Open_Network_Computing_Remote_Procedure_Call" target="_blank" rel="noopener" title="Open Network Computing Remote Procedure Call">ONC/RPC</a></li>
<li><a href="https://zh.wikipedia.org/wiki/Real-time_Transport_Protocol" target="_blank" rel="noopener" title="Real-time Transport Protocol">RTP</a></li>
<li><a href="https://zh.wikipedia.org/wiki/Real_Time_Streaming_Protocol" target="_blank" rel="noopener" title="Real Time Streaming Protocol">RTSP</a></li>
<li><a href="https://zh.wikipedia.org/wiki/Routing_Information_Protocol" target="_blank" rel="noopener" title="Routing Information Protocol">RIP</a></li>
<li><a href="https://zh.wikipedia.org/wiki/Session_Initiation_Protocol" target="_blank" rel="noopener" title="Session Initiation Protocol">SIP</a></li>
<li><a href="https://zh.wikipedia.org/wiki/%E7%AE%80%E5%8D%95%E9%82%AE%E4%BB%B6%E4%BC%A0%E8%BE%93%E5%8D%8F%E8%AE%AE" target="_blank" rel="noopener" title="简单邮件传输协议">SMTP</a></li>
<li><a href="https://zh.wikipedia.org/wiki/Simple_Network_Management_Protocol" target="_blank" rel="noopener" title="Simple Network Management Protocol">SNMP</a></li>
<li><a href="https://zh.wikipedia.org/wiki/Secure_Shell" target="_blank" rel="noopener" title="Secure Shell">SSH</a></li>
<li><a href="https://zh.wikipedia.org/wiki/Telnet" target="_blank" rel="noopener" title="Telnet">Telnet</a></li>
<li><a href="https://zh.wikipedia.org/wiki/%E5%8F%AF%E6%89%A9%E5%B1%95%E6%B6%88%E6%81%AF%E4%B8%8E%E5%AD%98%E5%9C%A8%E5%8D%8F%E8%AE%AE" target="_blank" rel="noopener" title="可扩展消息与存在协议">XMPP</a></li>
<li><a href="https://zh.wikipedia.org/wiki/Category:%E5%BA%94%E7%94%A8%E5%B1%82%E5%8D%8F%E8%AE%AE" target="_blank" rel="noopener" title="Category:应用层协议"><em>更多...</em></a></li>
</ul>
<p><a href="https://zh.wikipedia.org/wiki/%E4%BC%A0%E8%BE%93%E5%B1%82" target="_blank" rel="noopener" title="传输层">传输层</a></p>
<ul>
<li><a href="https://zh.wikipedia.org/wiki/Transmission_Control_Protocol" target="_blank" rel="noopener" title="Transmission Control Protocol">TCP</a></li>
<li><a href="https://zh.wikipedia.org/wiki/User_Datagram_Protocol" target="_blank" rel="noopener" title="User Datagram Protocol">UDP</a></li>
<li><a href="https://zh.wikipedia.org/wiki/%E5%82%B3%E8%BC%B8%E5%B1%A4%E5%AE%89%E5%85%A8%E6%80%A7%E5%8D%94%E5%AE%9A" target="_blank" rel="noopener" title="传输层安全性协定">TLS／SSL</a></li>
<li><a href="https://zh.wikipedia.org/wiki/Datagram_Congestion_Control_Protocol" target="_blank" rel="noopener" title="Datagram Congestion Control Protocol">DCCP</a></li>
<li><a href="https://zh.wikipedia.org/wiki/Stream_Control_Transmission_Protocol" target="_blank" rel="noopener" title="Stream Control Transmission Protocol">SCTP</a></li>
<li><a href="https://zh.wikipedia.org/wiki/Resource_Reservation_Protocol" target="_blank" rel="noopener" title="Resource Reservation Protocol">RSVP</a></li>
<li><a href="https://zh.wikipedia.org/wiki/Category:%E4%BC%A0%E8%BE%93%E5%B1%82%E5%8D%8F%E8%AE%AE" target="_blank" rel="noopener" title="Category:传输层协议"><em>更多...</em></a></li>
</ul>
<p><a href="https://zh.wikipedia.org/wiki/%E7%B6%B2%E7%B5%A1%E5%B1%A4" target="_blank" rel="noopener" title="网络层">网路层</a></p>
<ul>
<li><a href="https://zh.wikipedia.org/wiki/Internet_Protocol" target="_blank" rel="noopener" title="Internet Protocol">IP</a> 
<ul>
<li><a href="https://zh.wikipedia.org/wiki/IPv4" target="_blank" rel="noopener" title="IPv4">IPv4</a></li>
<li><a href="https://zh.wikipedia.org/wiki/IPv6" target="_blank" rel="noopener" title="IPv6">IPv6</a></li>
</ul></li>
<li><a href="https://zh.wikipedia.org/wiki/Internet_Control_Message_Protocol" target="_blank" rel="noopener" title="Internet Control Message Protocol">ICMP</a></li>
<li><a href="https://zh.wikipedia.org/wiki/ICMPv6" target="_blank" rel="noopener" title="ICMPv6">ICMPv6</a></li>
<li><a href="https://zh.wikipedia.org/wiki/%E6%98%8E%E7%A2%BA%E6%93%81%E5%A1%9E%E9%80%9A%E7%9F%A5" target="_blank" rel="noopener" title="明确拥塞通知">ECN</a></li>
<li><a href="https://zh.wikipedia.org/wiki/Internet_Group_Management_Protocol" target="_blank" rel="noopener" title="Internet Group Management Protocol">IGMP</a></li>
<li><a href="https://zh.wikipedia.org/wiki/Open_Shortest_Path_First" target="_blank" rel="noopener" title="Open Shortest Path First">OSPF</a></li>
<li><a href="https://zh.wikipedia.org/wiki/IPsec" target="_blank" rel="noopener" title="IPsec">IPsec</a></li>
<li><a href="https://zh.wikipedia.org/wiki/Category:%E7%BD%91%E7%BB%9C%E5%B1%82%E5%8D%8F%E8%AE%AE" target="_blank" rel="noopener" title="Category:网络层协议"><em>更多...</em></a></li>
</ul>
<p><a href="https://zh.wikipedia.org/w/index.php?title=%E9%80%A3%E7%B5%90%E5%B1%A4&amp;action=edit&amp;redlink=1" target="_blank" rel="noopener">连结层</a></p>
<ul>
<li><a href="https://zh.wikipedia.org/wiki/Address_Resolution_Protocol" target="_blank" rel="noopener" title="Address Resolution Protocol">ARP</a></li>
<li><a href="https://zh.wikipedia.org/wiki/Neighbor_Discovery_Protocol" target="_blank" rel="noopener" title="Neighbor Discovery Protocol">NDP</a></li>
<li><a href="https://zh.wikipedia.org/wiki/Tunneling_protocol" target="_blank" rel="noopener" title="Tunneling protocol">Tunnels</a> 
<ul>
<li><a href="https://zh.wikipedia.org/wiki/Layer_2_Tunneling_Protocol" target="_blank" rel="noopener" title="Layer 2 Tunneling Protocol">L2TP</a></li>
</ul></li>
<li><a href="https://zh.wikipedia.org/wiki/Point-to-Point_Protocol" target="_blank" rel="noopener" title="Point-to-Point Protocol">PPP</a></li>
<li><a href="https://zh.wikipedia.org/wiki/Media_access_control" target="_blank" rel="noopener" title="Media access control">MAC</a> 
<ul>
<li><a href="https://zh.wikipedia.org/wiki/Ethernet" target="_blank" rel="noopener" title="Ethernet">Ethernet</a></li>
<li><a href="https://zh.wikipedia.org/wiki/Digital_subscriber_line" target="_blank" rel="noopener" title="Digital subscriber line">DSL</a></li>
<li><a href="https://zh.wikipedia.org/wiki/Integrated_Services_Digital_Network" target="_blank" rel="noopener" title="Integrated Services Digital Network">ISDN</a></li>
<li><a href="https://zh.wikipedia.org/wiki/Fiber_Distributed_Data_Interface" target="_blank" rel="noopener" title="Fiber Distributed Data Interface">FDDI</a></li>
</ul></li>
<li><a href="https://zh.wikipedia.org/wiki/Category:%E9%93%BE%E8%B7%AF%E5%8D%8F%E8%AE%AE" target="_blank" rel="noopener" title="Category:链路协议"><em>更多...</em></a></li>
</ul>
<p><img src="https://2020.iosdevlog.com/2020/04/13/network/0.png" /></p>
<p><img src="https://2020.iosdevlog.com/2020/04/13/network/1.png" /></p>
<h2 id="网络分层的真实含义是什么2">网络分层的真实含义是什么?<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></h2>
<p><img src="https://2020.iosdevlog.com/2020/04/13/network/2.jpg" /></p>
<ol type="1">
<li>始终想象自己是一个处理网络包的程序:
<ul>
<li>如何拿到网络包，如何根据规则进行处理，如何发出去;</li>
</ul></li>
<li>始终牢记一个原则:
<ul>
<li>只要是在网络上跑的包，都是完整的。可以有下层没上层，绝对不可能有上层没下层。</li>
</ul></li>
</ol>
<p>对 TCP 协议来说，三次握手也好，重试也好，只要想发出去包，就要有 IP 层和 MAC 层，不然 是发不出去的。</p>
<h2 id="ifconfig">ifconfig</h2>
<ul>
<li>Windows
<ul>
<li>ifconfig</li>
</ul></li>
<li>Linux
<ul>
<li>net-tools
<ul>
<li>ifconfig</li>
</ul></li>
<li>iproute2
<ul>
<li>ip addr</li>
</ul></li>
</ul></li>
</ul>
<blockquote>
<p><code>IP 地址</code> 是一个网卡在网络世界的 <strong>通讯地址</strong>，相当于我们现实世界的门牌号码。</p>
</blockquote>
<p><img src="https://2020.iosdevlog.com/2020/04/13/network/3.jpg" /></p>
<h3 id="无类型域间选路cidr">无类型域间选路(CIDR)</h3>
<p>于是有了一个折中的方式叫作无类型域间选路，简称 CIDR。</p>
<p>这种方式打破了原来设计的几类地址的做法，将 32 位的 IP 地址一分为二，前面是网络号，后面是主机号。</p>
<p><code>10.100.122.2/24</code>，这个 IP 地址中有一个 <em>斜杠</em>，斜杠后面有个数字 <code>24</code>。这种地址表示形式，就是 CIDR。后面 24 的意思是，32 位中，前 24 位是网络号，后 8 位是主机号。</p>
<blockquote>
<p>MAC 地址更像是 <strong>身份证</strong>，是一个唯一的标识。</p>
</blockquote>
<h3 id="公有-ip-地址和私有-ip-地址">公有 IP 地址和私有 IP 地址</h3>
<p><img src="https://2020.iosdevlog.com/2020/04/13/network/4.jpg" /></p>
<h3 id="排队规则qdisc-queueing-discipline">排队规则（qdisc， queueing discipline）</h3>
<ul>
<li>pfifo
<ul>
<li>不对进入的数据包做任何的处理，数据包采用先入先出的方式通过队列</li>
</ul></li>
<li>pfifo_fast
<ul>
<li>三个波段(band)</li>
<li>每个波段里面，使用先进先出规则</li>
<li>band 0 的优先级最高</li>
</ul></li>
</ul>
<p>数据包是按照服务类型(Type of Service，TOS)被分配多三个波段(band)里面的。<code>TOS</code> 是 IP 头里 面的一个字段，代表了当前的包是高优先级的，还是低优先级的。</p>
<ul>
<li>IP 是地址，有定位功能</li>
<li>MAC 是身份证，无定位功能</li>
<li>CIDR 可以用来判断是不是本地人</li>
<li>IP 分公有的 IP 和私有的 IP</li>
</ul>
<h3 id="网络设备的状态标识net_device-flags">网络设备的状态标识（net_device flags）</h3>
<ul>
<li>UP：网卡处于启动的状态</li>
<li>BROADCAST：网卡有广播地址，可以发送广播包</li>
<li>MULTICAST：发送多播包</li>
<li>LOWER_UP： 网线插着，L1 是启动的</li>
<li>MTU （二层 MAC 层）1500：最大传输单元 MTU 为 1500，这是以太网的默认值</li>
</ul>
<h2 id="dhcp与pxe">DHCP与PXE</h2>
<p>如何配置 IP 地址</p>
<p><code>net-tools</code></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo ifconfig eth1 10.0.0.1/24 </span><br><span class="line">sudo ifconfig eth1 up</span><br></pre></td></tr></table></figure>
<p><code>iproute2</code></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo ip addr add 10.0.0.1/24 dev eth1</span><br><span class="line">sudo ip link <span class="built_in">set</span> up eth1</span><br></pre></td></tr></table></figure>
<p>Linux 默认的逻辑是，如果这是一个跨网段的调用，它便不会直接将包发送到网络上，而是企图将包发 送到网关。</p>
<p>配置文件</p>
<ol type="1">
<li>CIDR（IP地址）</li>
<li>子网掩码</li>
<li>广播地址</li>
<li>网关地址</li>
</ol>
<p>动态主机配置协议（Dynamic Host Configuration Protocol，DHCP）</p>
<ol type="1">
<li>DHCP <strong>D</strong>iscover</li>
<li>DHCP <strong>O</strong>ffer</li>
<li>DHCP <strong>R</strong>equest</li>
<li>DHCP <strong>A</strong>ck</li>
</ol>
<p><img src="https://2020.iosdevlog.com/2020/04/13/network/5.png" /></p>
<p>dhcp_protocol<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a></p>
<h3 id="预启动执行环境preboot-execution-environment-pxe">预启动执行环境（Preboot Execution Environment / <strong>PXE</strong>)</h3>
<p>操作系统启动</p>
<ol type="1">
<li>BIOS（Basic Input output System)</li>
<li>读取 MBR(Master Boot Record， 主引导记录)</li>
<li>启动 GRUB（GRand Unified Bootloader，多重操作系统启动管理器)</li>
<li>GRUB 加载内核，根文件系统 initramfs</li>
<li>启动内核</li>
</ol>
<p><img src="https://2020.iosdevlog.com/2020/04/13/network/6.jpg" /></p>
<h2 id="从二层到三层">从二层到三层</h2>
<h3 id="第一层物理层">第一层：物理层</h3>
<h4 id="最小的局域网lan">最小的局域网（LAN）</h4>
<p>2 台电脑相连</p>
<ul>
<li>网线
<ul>
<li>水晶头</li>
<li>1,2 收</li>
<li>3,6 发</li>
<li>需要 1和3，2和6 交换位置</li>
</ul></li>
</ul>
<h4 id="集线器-hub-广播模式">集线器 / Hub （广播模式）</h4>
<ul>
<li>多台电脑相连</li>
<li>完全复制</li>
</ul>
<h3 id="第二层数据链路层mac层-medium-access-control媒体访问控制">第二层：数据链路层（MAC）层 (Medium Access Control，媒体访问控制)</h3>
<ol type="1">
<li>信道化分</li>
<li>轮流协议</li>
<li>随机接入协议
<ul>
<li>以太网</li>
</ul></li>
</ol>
<p>第二层的网络包格式</p>
<p><img src="https://2020.iosdevlog.com/2020/04/13/network/7.jpg" /></p>
<h5 id="arp">ARP</h5>
<p>已知 IP 地址，求 MAC 地址的协议</p>
<p><img src="https://2020.iosdevlog.com/2020/04/13/network/8.jpg" /></p>
<p>报文</p>
<p><img src="https://2020.iosdevlog.com/2020/04/13/network/9.jpg" /></p>
<h4 id="交换机">交换机</h4>
<ul>
<li>转发表</li>
</ul>
<ol type="1">
<li>MAC 层是用来解决多路访问的堵车问题的;</li>
<li>ARP 是通过吼的方式来寻找目标 MAC 地址的，吼完之后记住一段时间，这个叫作缓存;</li>
<li>交换机是有MAC 地址学习能力的，学完了它就知道谁在哪儿了，不用广播了。</li>
</ol>
<h3 id="交换机与vlan">交换机与VLAN</h3>
<p>拓扑结构</p>
<p><img src="https://2020.iosdevlog.com/2020/04/13/network/10.jpg" /></p>
<p>环路问题</p>
<p><img src="https://2020.iosdevlog.com/2020/04/13/network/11.jpg" /></p>
<p>STP 协议</p>
<p>在数据结构中，有一个方法叫做 <strong>最小生成树</strong>。有环的我们常称为 <strong>图</strong>。将图中的环破了，就生成了树。在计算机网络中，生成树的算法叫作 <code>STP</code>，全称 <em>Spanning Tree Protocol</em>。</p>
<p><img src="https://2020.iosdevlog.com/2020/04/13/network/12.jpg" /></p>
<ul>
<li>Root Bridge，也就是根交换机。这个比较容易理解，可以比喻为“掌门”交换机，是某棵树的老大，是掌门，最大的大哥。</li>
<li>Designated Bridges，有的翻译为指定交换机。这个比较难理解，可以想像成一个“小弟”，对于树来说，就是一棵树的树枝。所谓“指定”的意思是，我拜谁做大哥，其他交换机通过这个交换机到达根交换机，也就相当于拜他做了大哥。这里注意是树枝，不是叶子，因为叶子往往是主机。</li>
<li>Bridge Protocol Data Units （BPDU） ，网桥协议数据单元。可以比喻为“相互比较实力”的协议。行走江湖，比的就是武功，拼的就是实力。当两个交换机碰见的时候，也就是相连的时候，就需要互相比一比内力了。BPDU 只有掌门能发，已经隶属于某个掌门的交换机只能传达掌门的指示。</li>
<li>Priority Vector，优先级向量。可以比喻为实力 （值越小越牛）。实力是啥？就是一组 ID 数目，[Root Bridge ID, Root Path Cost, Bridge ID, and Port ID]。为什么这样设计呢？这是因为要看怎么来比实力。先看 Root Bridge ID。拿出老大的 ID 看看，发现掌门一样，那就是师兄弟；再比 Root Path Cost，也即我距离我的老大的距离，也就是拿和掌门关系比，看同一个门派内谁和老大关系铁；最后比 Bridge ID，比我自己的 ID，拿自己的本事比。</li>
</ul>
<p><img src="https://2020.iosdevlog.com/2020/04/13/network/13.jpg" /></p>
<h3 id="虚拟局域网-vlan">虚拟局域网 (VLAN)</h3>
<p><img src="https://2020.iosdevlog.com/2020/04/13/network/14.jpg" /></p>
<p><img src="https://2020.iosdevlog.com/2020/04/13/network/15.jpg" /></p>
<p>当交换机的数目越来越多的时候，会遭遇环路问题，让网络包迷路，这就需要使用 STP 协议，通过华山论剑比武的方式，将有环路的图变成没有环路的树，从而解决环路问题。</p>
<p>交换机数目多会面临隔离问题，可以通过 VLAN 形成虚拟局域网，从而解决广播问题和安全问题。</p>
<h3 id="icmp-与-ping">ICMP 与 ping</h3>
<p>ping 是基于 ICMP 协议工作的（查询报文）。</p>
<p>ICMP 全称 <strong>Internet Control Message Protocol</strong>，就是互联网控制报文协议。</p>
<p>网络包在异常复杂的网络环境中传输时，常常会遇到各种各样的问题。</p>
<p><img src="https://2020.iosdevlog.com/2020/04/13/network/16.jpg" /></p>
<p><code>查询报文</code></p>
<p>常用的 ping 就是 <strong>查询报文</strong>，是一种主动请求，并且获得主动应答的 ICMP 协议。</p>
<ul>
<li>对 ping 的主动请求，进行网络抓包，称为 ICMP ECHO REQUEST。</li>
<li>主动请求的回复，称为 ICMP ECHO REPLY。</li>
</ul>
<p>比起原生的 ICMP，这里面多了两个字段：</p>
<ul>
<li>一个是标识符</li>
<li>另一个是序号</li>
</ul>
<p>在选项数据中，ping 还会存放发送请求的时间值，来计算往返时间，说明路程的长短。</p>
<p><code>差错报文</code></p>
<ol type="1">
<li>终点不可达
<ul>
<li>网络不可达</li>
<li>主机不可达</li>
<li>协议不可达</li>
<li>端口不可达</li>
<li>需要进行分片但设置了不分片位</li>
</ul></li>
<li>源站抑制
<ul>
<li>让源站放慢发送速度</li>
</ul></li>
<li>时间超时
<ul>
<li>超过网络包的生存时间还是没到</li>
</ul></li>
<li>路由重定向
<ul>
<li>让下次发给另一个路由器</li>
</ul></li>
</ol>
<p>差错报文的结构相对复杂一些。除了前面还是 IP，ICMP 的前 8 字节不变，后面则跟上出错的那个 IP 包的 IP 头和 IP 正文的前 8 个字节。</p>
<p>而且这类侦查兵特别恪尽职守，不但自己返回来报信，还把一部分遗物也带回来。</p>
<p><code>ping</code>：查询报文类型的使用</p>
<p><img src="https://2020.iosdevlog.com/2020/04/13/network/17.jpg" /></p>
<p><code>Traceroute</code>：差错报文类型的使用</p>
<p>traceroute，现代 Linux系统 称为 tracepath，Windows系统称为 tracert，是一种电脑网络工具。它可显示封包在 IP 网络经过的路由器的 IP 地址。</p>
<p>它会使用 ICMP 的规则，故意制造一些能够产生错误的场景。</p>
<p>Traceroute 的第一个作用就是故意设置特殊的 TTL，来追踪去往目的地时沿途经过的路由器。</p>
<p>Traceroute 的参数指向某个目的 IP 地址，它会发送一个 UDP 的数据包。将 TTL 设置成 1，也就是说一旦遇到一个路由器或者一个关卡，就表示它“牺牲”了。</p>
<p>Traceroute 还有一个作用是故意设置不分片，从而确定路径的 MTU。</p>
<p>ICMP 相当于网络世界的侦察兵。</p>
<p>两种类型的 ICMP 报文，一种是主动探查的查询报文，一种异常报告的差错报文</p>
<ol type="1">
<li>ping 使用查询报文</li>
<li>Traceroute 使用差错报文</li>
</ol>
<h3 id="网关">网关</h3>
<p>出入门</p>
<p>路由器会有内网网口和外网网口。</p>
<p>配置网卡</p>
<p>当然 DHCP 是可以默认配置的。在进行网卡配置的时候，除了 IP 地址，还需要配置一个 <code>Gateway</code> 的东西，这个就是 <code>网关</code>。</p>
<figure>
<img src="https://2020.iosdevlog.com/2020/04/13/network/18.jpg" alt="" /><figcaption>MAC 头和 IP 头</figcaption>
</figure>
<p>MAC 头</p>
<ol type="1">
<li>目标 MAC 地址</li>
<li>源 MAC 地址</li>
<li>协议类型
<ol type="1">
<li>IP 协议<br />
IP 头</li>
</ol></li>
<li>版本号： IPv4</li>
<li>服务类型 TOS (Type of Service)</li>
<li>TTL</li>
<li>协议
<ol type="1">
<li>TCP</li>
<li>UDP</li>
</ol></li>
<li>源 IP</li>
<li>目标 IP
<ol type="1">
<li>CIDR 和子网掩码</li>
<li>判断是否在同一网段
<ol type="1">
<li>同一个网段
<ol type="1">
<li>通过 ARP 获得 MAC 地址</li>
</ol></li>
<li>不是同一网段
<ol start="2" type="1">
<li>需要发往默认网关 Gateway</li>
</ol></li>
</ol></li>
</ol></li>
</ol>
<p>网关往往是一个 <code>路由器</code>，是一个 <code>三层</code> 转发的设备。</p>
<p>一个路由器往往有多个网口，如果是一台服务器做这个事情，则就有多个网卡，其中一个网卡是和源 IP 同网段的。</p>
<p>很多情况下，人们把网关就叫作路由器。</p>
<p>其实不完全准确。</p>
<p>路由器是一台设备。</p>
<h4 id="静态路由">静态路由</h4>
<p>MAC 地址是一个局域网内才有效的地址。</p>
<p>因而，MAC 地址只要过网关，就必定会改变，因为已经换了局域网。</p>
<p>两者主要的区别在于 IP 地址是否改变。</p>
<ul>
<li>不改变 IP 地址的网关，称为 <code>转发网关</code>；</li>
</ul>
<p>“欧洲十国游”型</p>
<p><img src="https://2020.iosdevlog.com/2020/04/13/network/19.jpg" /></p>
<ul>
<li>改变 IP 地址的网关，称为 <code>NAT 网关</code>。</li>
</ul>
<p>Network Address Translation 地址转换，简称 NAT。<br />
网络地址端口转换NAPT（Network Address Port Translation）有端口号。</p>
<p>“玄奘西行”型</p>
<p><img src="https://2020.iosdevlog.com/2020/04/13/network/20.jpg" /></p>
<p>Source Network Address Translation 源地址转换，简称 SNAT。<br />
Destination Network Address Translation 目标地址转换，简称 SNAT。</p>
<p>路由表</p>
<p><img src="https://2020.iosdevlog.com/2020/04/13/network/21.jpg" /></p>
<ol type="1">
<li>如果离开本局域网，就需要经过网关，网关是路由器的一个网口；</li>
<li>路由器是一个三层设备，里面有如何寻找下一跳的规则；</li>
<li>经过路由器之后 MAC 头要变，如果 IP 不变，相当于不换护照的欧洲旅游，如果 IP 变，相当于换护照的玄奘西行。</li>
</ol>
<h4 id="动态路由">动态路由</h4>
<p><img src="https://2020.iosdevlog.com/2020/04/13/network/22.jpg" /></p>
<ul>
<li>距离矢量路由算法</li>
</ul>
<p>第一大类的算法称为距离矢量路由（distance vector routing）。它是基于 Bellman-Ford 算法的。</p>
<p>这种算法的基本思路是，每个路由器都保存一个路由表，包含多行，每行对应网络中的一个路由器，每</p>
<p>一行包含两部分信息，一个是要到目标路由器，从那条线出去，另一个是到目标路由器的距离。</p>
<p><img src="https://2020.iosdevlog.com/2020/04/13/network/23.jpg" /></p>
<p><img src="https://2020.iosdevlog.com/2020/04/13/network/24.jpg" /></p>
<ul>
<li>链路状态路由算法</li>
</ul>
<p>第二大类算法是链路状态路由（link state routing），基于 Dijkstra 算法。</p>
<p>这种算法的基本思路是：当一个路由器启动的时候，首先是发现邻居，向邻居 say hello，邻居都回复。</p>
<p>然后计算和邻居的距离，发送一个 echo，要求马上返回，除以二就是距离。然后将自己和邻居之间的链</p>
<p>路状态包广播出去，发送到整个网络的每个路由器。这样每个路由器都能够收到它和邻居之间的关系的信息。</p>
<p>每个路由器都能在自己本地构建一个完整的图，然后针对这个图使用 Dijkstra 算法，找到</p>
<p>两点之间的最短路径。</p>
<p>动态路由协议</p>
<ul>
<li>基于链路状态路由算法的 OSPF<br />
OSPF（Open Shortest Path First，开放式最短路径优先）就是这样一个基于链路状态路由协议，广泛</li>
</ul>
<p>应用在数据中心中的协议。由于主要用在数据中心内部，用于路由决策，因而称为内部网关协议</p>
<p>（Interior Gateway Protocol，简称IGP）。</p>
<p><img src="https://2020.iosdevlog.com/2020/04/13/network/25.jpg" /></p>
<ul>
<li>基于距离矢量路由算法的 BGP</li>
</ul>
<p>但是外网的路由协议，也即国家之间的，又有所不同。我们称为外网路由协议（Border Gateway Protocol，简称BGP）。</p>
<p><img src="https://2020.iosdevlog.com/2020/04/13/network/25.jpg" /></p>
<p>在一个国家内部，有路当然选近的走。但是国家之间，不光远近的问题，还有政策的问题。</p>
<p>路由分静态路由和动态路由，静态路由可以配置复杂的策略路由，控制转发策略；</p>
<p>动态路由主流算法有两种，距离矢量算法和链路状态算法。基于两种算法产生两种协议，BGP 协议和 OSPF 协议。</p>
<h2 id="最重要的传输层">最重要的传输层</h2>
<p>MAC 层定义本地局域网传输。<br />
IP 层定义了整个网络端到端的传输行为</p>
<p>这两层基本定义了这样的基因</p>
<blockquote>
<p>网络传输是以包为单位的，二层叫帧，网络层叫包，传输层叫段。 我们笼统地称为包。</p>
</blockquote>
<p>包单独传输，自行选路，在不同的设备封装解封装，不保证到达。基于这个基因， 生下来的孩子 UDP 完全继承了这些特性，几乎没有自己的思想。</p>
<h3 id="udp">UDP</h3>
<p>UDP 包头</p>
<p><img src="https://2020.iosdevlog.com/2020/04/13/network/27.jpg" /></p>
<p>UDP 的三大特点：</p>
<ol type="1">
<li>沟通简单</li>
<li>轻信他人</li>
<li>愣头青，做事不懂权变</li>
</ol>
<p>UDP 的三大使用场景</p>
<ol type="1">
<li>需要资源少，在网络情况比较好的内网，或者对于丢包不敏感的应用。</li>
<li>不需要一对一沟通，建立连接，而是可以广播的应用。</li>
<li>需要处理速度快，时延低，可以容忍少数丢包，但是要求即便网络拥塞，也毫不退缩，一往无前的时候。</li>
</ol>
<p>基于 UDP 定制化的五个例子</p>
<ol type="1">
<li>网页或者 APP 的访问
<ol type="1">
<li>QUIC（全称Quick UDP Internet Connections，快速 UDP 互联网连接）是 Google 提出的一种基于 UDP 改进的通信协议，其目的是降低网络通信的延迟，提供更好的用户互动体验。</li>
</ol></li>
<li>流媒体的协议</li>
<li>实时游戏</li>
<li>IoT 物联网</li>
<li>移动通信领域</li>
</ol>
<p>如果将 TCP 比作成熟的社会人，UDP 则是头脑简单的小朋友。TCP 复杂，UDP 简单；<br />
TCP 维护连接，UDP 谁都相信；<br />
TCP 会坚持知进退；UDP 愣头青一个，勇往直前；<br />
UDP 虽然简单，但它有简单的用法。它可以用在环境简单、需要多播、应用层自己控制传输的地方。例如 DHCP、VXLAN、QUIC 等。</p>
<h3 id="tcp">TCP</h3>
<p>TCP 包头格式</p>
<p><img src="https://2020.iosdevlog.com/2020/04/13/network/28.jpg" /></p>
<ul>
<li>顺序问题，稳重不乱；</li>
<li>丢包问题，承诺靠谱；</li>
<li>连接维护，有始有终；</li>
<li>流量控制，把握分寸；</li>
<li>拥塞控制，知进知退。</li>
</ul>
<p>TCP 的三次握手</p>
<p><img src="https://2020.iosdevlog.com/2020/04/13/network/29.jpg" /></p>
<p>SYN （Synchronize Sequence Number，同步序列编号）<br />
ACK （Acknokedgement）用于回复<br />
RST （Reset）</p>
<p>TCP 四次挥手</p>
<p><img src="https://2020.iosdevlog.com/2020/04/13/network/30.jpg" /></p>
<p>FIN （finish）</p>
<p>TCP 状态机</p>
<p><img src="https://2020.iosdevlog.com/2020/04/13/network/31.jpg" /></p>
<p>TCP 包头很复杂，但是主要关注五个问题，顺序问题，丢包问题，连接维护，流量控制，拥塞控制；</p>
<p>连接的建立是经过三次握手，断开的时候四次挥手。</p>
<p>顺序问题、丢包问题、流量控制都是通过滑动窗口来解决的，这其实就相当于你领导和你的工作备忘 录，布置过的工作要有编号，干完了有反馈，活不能派太多，也不能太少;</p>
<p>拥塞控制是通过拥塞窗口来解决的，相当于往管道里面倒水，快了容易溢出，慢了浪费带宽，要摸着 石头过河，找到最优值。</p>
<h3 id="socket">Socket</h3>
<p>Socket 这个名字很有意思，可以作插口或者插槽讲。虽然我们是写软件程序，但是你可以想象为弄一根</p>
<p>网线，一头插在客户端，一头插在服务端，然后进行通信。所以在通信之前，双方都要建立一个 Socket。</p>
<p>Socket 函数需要指定到底是 IPv4 还是 IPv6，分别对应设置为 AF_INET 和 AF_INET6。</p>
<p>另外，还要指定到底是 TCP 还是 UDP。还记得咱们前面讲过的，TCP 协议是基于数据流的，所以设置为 SOCK_STREAM，而 UDP 是基于数据报的，因而设置为 SOCK_DGRAM。</p>
<h4 id="基于-tcp-协议的-socket-程序函数调用过程">基于 TCP 协议的 Socket 程序函数调用过程</h4>
<p><img src="https://2020.iosdevlog.com/2020/04/13/network/32.jpg" /></p>
<p>TCP 的 Socket 就是一个文件流，是非常准确的。因为，Socket 在 Linux 中就是以文件的形式存在的。</p>
<p>除此之外，还存在文件描述符。写入和读出，也是通过文件描述符。</p>
<p>文件描述符是一个整数，是这个数组的下标。</p>
<p><img src="https://2020.iosdevlog.com/2020/04/13/network/33.jpg" /></p>
<h4 id="基于-udp-协议的-socket-程序函数调用过程">基于 UDP 协议的 Socket 程序函数调用过程</h4>
<p><img src="https://2020.iosdevlog.com/2020/04/13/network/34.jpg" /></p>
<h4 id="服务器如何接更多的项目">服务器如何接更多的项目？</h4>
<p>系统会用一个四元组来标识一个 TCP 连接。</p>
<p>{本机 IP, 本机端口, 对端 IP, 对端端口}</p>
<ul>
<li>多进程</li>
</ul>
<p><img src="https://2020.iosdevlog.com/2020/04/13/network/35.jpg" /></p>
<ul>
<li>多线程</li>
</ul>
<p><img src="https://2020.iosdevlog.com/2020/04/13/network/36.jpg" /></p>
<ul>
<li>IO 多路复用，一个线程维护多个 Socket</li>
<li>IO 多路复用，从“派人盯着”到“有事通知” epoll</li>
</ul>
<p>epoll 被称为解决C10K 问题的利器。</p>
<p><img src="https://2020.iosdevlog.com/2020/04/13/network/37.jpg" /></p>
<p>记住 TCP 和 UDP 的 Socket 的编程中，客户端和服务端都需要调用哪些函数；</p>
<p>写一个能够支撑大量连接的高并发的服务端不容易，需要多进程、多线程，而 epoll 机制能解决。</p>
<h2 id="最常用的应用层">最常用的应用层</h2>
<h3 id="http-协议">HTTP 协议</h3>
<p>HTTP 的报文大概分为三大部分。</p>
<p><img src="https://2020.iosdevlog.com/2020/04/13/network/38.jpg" /></p>
<ol type="1">
<li>请求行
<ol type="1">
<li>GET 获取 R</li>
<li>POST 创建 C</li>
<li>PUT 修改 U</li>
<li>DELETE 删除 D</li>
</ol></li>
<li>请求的首部
<ol type="1">
<li>Accept-Charset：客户端可以接受的字符集</li>
<li>Content-Type：正文的格式</li>
</ol></li>
<li>请求的正文实体</li>
</ol>
<p><img src="https://2020.iosdevlog.com/2020/04/13/network/39.jpg" /></p>
<p>HTTP 2.0</p>
<p><img src="https://2020.iosdevlog.com/2020/04/13/network/40.jpg" /></p>
<p><img src="https://2020.iosdevlog.com/2020/04/13/network/41.jpg" /></p>
<p>QUIC 协议</p>
<p>机制一：自定义连接机制<br />
机制二：自定义重传机制</p>
<p><img src="https://2020.iosdevlog.com/2020/04/13/network/42.jpg" /></p>
<p>机制三：无阻塞的多路复用<br />
机制四：自定义流量控制</p>
<p><img src="https://2020.iosdevlog.com/2020/04/13/network/43.jpg" /></p>
<p>HTTP 协议虽然很常用，也很复杂，重点记住 GET、POST、 PUT、DELETE 这几个方法，以及重要的首部字段；</p>
<p>HTTP 2.0 通过头压缩、分帧、二进制编码、多路复用等技术提升性能；</p>
<p>QUIC 协议通过基于 UDP 自定义的类似 TCP 的连接、重试、多路复用、流量控制技术，进一步提升性能。</p>
<h3 id="https协议">HTTPS协议</h3>
<p>加密</p>
<ol type="1">
<li>对称加密</li>
<li>非对称加密</li>
</ol>
<p>这个证书是怎么生成的呢？会不会有人假冒权威机构颁发证书呢？就像有假身份证、假户口本一样。</p>
<p>生成证书需要发起一个证书请求，然后将这个请求发给一个权威机构去认证，这个权威机构我们称为 CA（ Certifcate Authority）。</p>
<p><img src="https://2020.iosdevlog.com/2020/04/13/network/44.jpg" /></p>
<h3 id="流媒体协议">流媒体协议</h3>
<p>压缩</p>
<ol type="1">
<li>空间冗余</li>
<li>时间冗余</li>
<li>视觉冗余</li>
<li>编码冗余</li>
</ol>
<p><img src="https://2020.iosdevlog.com/2020/04/13/network/45.jpg" /></p>
<p>视频编码的两大流派</p>
<ol type="1">
<li>ITU（International Telecommunications Union）的 VECG（Video Coding Experts Group），这个称为国际电联下的 VECG。
<ul>
<li>H.261、 H.262、H.263、H.264、H.265</li>
</ul></li>
<li>ISO（International Standards Organization）的 MPEG（Moving Picture Experts Group），这个是ISO 旗下的 MPEG，本来是做视频存储的。例如，编码后保存在 VCD 和 DVD 中。当然后来也慢慢侧重视频传输了。
<ul>
<li>MPEG-1、MPEG-2、MPEG-4、MPEG-7</li>
</ul></li>
</ol>
<p>ITU-T（国际电信联盟电信标准化部门，ITU Telecommunication Standardization Sector）与 MPEG 联合制定了 H.264/MPEG-4 AVC</p>
<p><img src="https://2020.iosdevlog.com/2020/04/13/network/46.jpg" /></p>
<p>编码：如何将丰富多彩的图片变成二进制流？</p>
<p><code>I 帧</code>，也称关键帧。里面是完整的图片，只需要本帧数据，就可以完成解码。</p>
<p><code>P 帧</code>，前向预测编码帧。P 帧表示的是这一帧跟之前的一个关键帧（或 P 帧）的差别，解码时需要用之前缓存的画面，叠加上和本帧定义的差别，生成最终画面。</p>
<p><code>B 帧</code>，双向预测内插编码帧。B 帧记录的是本帧与前后帧的差别。要解码 B 帧，不仅要取得之前的缓存画面，还要解码之后的画面，通过前后画面的数据与本帧数据的叠加，取得最终的画面。</p>
<p>可以看出，I 帧最完整，B 帧压缩率最高，而压缩后帧的序列，应该是在 <code>IBBP</code> 的间隔出现的。这就是通过时序进行编码。</p>
<p><img src="https://2020.iosdevlog.com/2020/04/13/network/47.jpg" /></p>
<p>在一帧中，分成多个片，每个片中分成多个宏块，每个宏块分成多个子块，这样将一张大的图分解成一个个小块，可以方便进行空间上的编码。</p>
<p>尽管时空非常立体的组成了一个序列，但是总归还是要压缩成一个二进制流。这个流是有结构的，是一个个的网络提取层单元（NALU，Network Abstraction Layer Unit）。变成这种格式就是为了传输，因为网络上的传输，默认的是一个个的包，因而这里也就分成了一个个的单元。</p>
<p><img src="https://2020.iosdevlog.com/2020/04/13/network/48.jpg" /></p>
<p>每一个 NALU 首先是一个起始标识符，用于标识 NALU 之间的间隔；然后是 NALU 的头，里面主要配置了 NALU 的类型；最终 Payload 里面是 NALU 承载的数据。</p>
<p>在 NALU 头里面，主要的内容是类型 NAL Type。</p>
<p><code>0x07</code> 表示 SPS，是序列参数集， 包括一个图像序列的所有信息，如图像尺寸、视频格式等。</p>
<p><code>0x08</code> 表示 PPS，是图像参数集，包括一个图像的所有分片的所有相关信息，包括图像类型、序列号等。</p>
<p><img src="https://2020.iosdevlog.com/2020/04/13/network/49.jpg" /></p>
<p>推流：如何把数据流打包传输到对端？</p>
<p>RTMP 是基于 TCP 的，因而肯定需要双方建立一个 TCP 的连接。</p>
<p>在有 TCP 的连接的基础上，还需要建立一个 RTMP 的连接，也即在程序里面，你需要调用 RTMP 类库的 Connect 函数，显示创建一个连接。</p>
<p><img src="https://2020.iosdevlog.com/2020/04/13/network/50.jpg" /></p>
<p>一开始双方就要知道对方的时间戳。</p>
<p>未来沟通这些事情，需要发送六条消息：客户端发送 C0、C1、 C2，服务器发送 S0、 S1、 S2。</p>
<p>RTMP Packet 包 Message 的格式</p>
<p><img src="https://2020.iosdevlog.com/2020/04/13/network/51.jpg" /></p>
<p>流媒体服务器，整个过程就</p>
<p><img src="https://2020.iosdevlog.com/2020/04/13/network/52.jpg" /></p>
<p>分发网络</p>
<p><img src="https://2020.iosdevlog.com/2020/04/13/network/53.jpg" /></p>
<p>客户端通过 RTMP 拉流的过程</p>
<p><img src="https://2020.iosdevlog.com/2020/04/13/network/54.jpg" /></p>
<p>视频名词比较多，编码两大流派达成了一致，都是通过时间、空间的各种算法来压缩数据；</p>
<p>压缩好的数据，为了传输组成一系列 NALU，按照帧和片依次排列；</p>
<p>排列好的 NALU，在网络传输的时候，要按照 RTMP 包的格式进行包装，RTMP 的包会拆分成</p>
<p>Chunk 进行传输；</p>
<p>推送到流媒体集群的视频流经过转码和分发，可以被客户端通过 RTMP 协议拉取，然后组合为</p>
<p>NALU，解码成视频格式进行播放。</p>
<h3 id="p2p协议">P2P协议</h3>
<p>下载</p>
<ol type="1">
<li>HTTP</li>
<li>FTP 文件传输协议
<ol type="1">
<li>主动模式（PORT）</li>
<li>被动模式（PASV</li>
</ol></li>
<li>P2P (peer-to-peer)</li>
</ol>
<p>种子（.torrent）文件</p>
<ol type="1">
<li>announce（tracker URL）</li>
<li>文件信息
<ol type="1">
<li>info 区</li>
<li>Name 字段</li>
<li>每个段的大小</li>
<li>段哈希值</li>
</ol></li>
</ol>
<p><img src="https://2020.iosdevlog.com/2020/04/13/network/55.jpg" /></p>
<p>去中心化网络（DHT）</p>
<p>DHT 网络是如何查找朋友的？</p>
<p><img src="https://2020.iosdevlog.com/2020/04/13/network/56.jpg" /></p>
<p>下载一个文件可以使用 HTTP 或 FTP，这两种都是集中下载的方式，而 P2P 则换了一种思路，采取非中心化下载的方式；</p>
<p>P2P 也是有两种，一种是依赖于 tracker 的，也即元数据集中，文件数据分散；另一种是基于分布式的哈希算法，元数据和文件数据全部分散。</p>
<h2 id="陌生的数据中心">陌生的数据中心</h2>
<h3 id="dns协议">DNS协议</h3>
<p>DNS(Domain Name System,域名系统)_协议（DNS）是一种分布式网络目录服务，主要用于域名与 IP 地址的相互转换，以及控制因特网的电子邮件的发送。</p>
<ol type="1">
<li>根 DNS 服务器 ：返回顶级域 DNS 服务器的 IP 地址</li>
<li>顶级域 DNS 服务器：返回权威 DNS 服务器的 IP 地址</li>
<li>权威 DNS 服务器 ：返回相应主机的 IP 地址</li>
</ol>
<p><img src="https://2020.iosdevlog.com/2020/04/13/network/57.jpg" /></p>
<p>DNS 解析流程</p>
<p><img src="https://2020.iosdevlog.com/2020/04/13/network/58.jpg" /></p>
<p>负载均衡</p>
<p><img src="https://2020.iosdevlog.com/2020/04/13/network/59.jpg" /></p>
<p>DNS 是网络世界的地址簿，可以通过域名查地址，因为域名服务器是按照树状结构组织的，因而域名查找是使用递归的方法，并通过缓存的方式增强性能；</p>
<p>在域名和 IP 的映射过程中，给了应用基于域名做负载均衡的机会，可以是简单的负载均衡，也可以根据地址和运营商做全局的负载均衡。</p>
<h3 id="httpdns">HTTPDNS</h3>
<p>HTTPDNS 服务器的工作模式</p>
<p><img src="https://2020.iosdevlog.com/2020/04/13/network/60.jpg" /></p>
<p>HTTPDNS 服务器的调度设计</p>
<p><img src="https://2020.iosdevlog.com/2020/04/13/network/61.jpg" /></p>
<h3 id="cdn">CDN</h3>
<p>Content Delivery Network，即内容分发网络。</p>
<p>分布在各个地方的各个数据中心的节点，就称为 <code>边缘节点</code>。</p>
<p><img src="https://2020.iosdevlog.com/2020/04/13/network/62.jpg" /></p>
<p><img src="https://2020.iosdevlog.com/2020/04/13/network/63.jpg" /></p>
<ol type="1">
<li>根据用户 IP 地址，判断哪一台服务器距用户最近；</li>
<li>用户所处的运营商；</li>
<li>根据用户所请求的 URL 中携带的内容名称，判断哪一台服务器上有用户所需的内容；</li>
<li>查询各个服务器当前的负载情况，判断哪一台服务器尚有服务能力。</li>
</ol>
<p>接入层缓存的架构</p>
<p><img src="https://2020.iosdevlog.com/2020/04/13/network/64.jpg" /></p>
<p>防盗链</p>
<ol type="1">
<li>refer 机制</li>
<li>时间戳防盗链</li>
</ol>
<p>CDN 和电商系统的分布式仓储系统一样，分为中心节点、区域节点、边缘节点，而数据缓存在离用户最近的位置。</p>
<p>CDN 最擅长的是缓存静态数据，除此之外还可以缓存流媒体数据，这时候要注意使用防盗链。它也支持动态数据的缓存，一种是边缘计算的生鲜超市模式，另一种是链路优化的冷链运输模式。</p>
<h3 id="数据中心">数据中心</h3>
<p>数据中心分为三层。</p>
<p>服务器连接到接入层，然后是汇聚层，再然后是核心层，最外面是边界路由器和安全设备。</p>
<p>数据中心的所有链路都需要高可用性。服务器需要绑定网卡，交换机需要堆叠，三层设备可以通过等价路由，二层设备可以通过TRILL协议。</p>
<p>随着云和大数据的发展，东西流量相对于南北流量越来越重要，因而演化为叶脊网络结构。</p>
<h3 id="vpn">VPN</h3>
<p>VPN，全名 Virtual Private Network，虚拟专用网，就是利用开放的公众网络，建立专用数据传输通道，将远程的分支机构、移动办公人员等连接起来。</p>
<p><img src="https://2020.iosdevlog.com/2020/04/13/network/65.jpg" /></p>
<p>VPN是如何工作的？</p>
<p>VPN通过隧道技术在公众网络上仿真一条点到点的专线，是通过利用一种协议来传输另外一种协议的技术，这里面涉及三种协议：乘客协议、隧道协议和承载协议。</p>
<p><img src="https://2020.iosdevlog.com/2020/04/13/network/66.jpg" /></p>
<p>我们以 IPsec 协议为例来说明。</p>
<p>一种十分安全的VPN，IPsec VPN。这是基于IP协议的安全隧道协议，为了保证在公网上面信息的安全，因而采取了一定的机制保证安全性。</p>
<ul>
<li>机制一：私密性</li>
<li>机制二：完整性</li>
<li>机制三：真实性</li>
</ul>
<p><img src="https://2020.iosdevlog.com/2020/04/13/network/67.jpg" /></p>
<p>协议簇</p>
<ul>
<li>两种协议的区别在于封装网络包的格式不一样
<ul>
<li>AH（Authentication Header），只能进行数据摘要 ，不能实现数据加密。</li>
<li>ESP（Encapsulating Security Payload），能够进行数据加密和数据摘要</li>
</ul></li>
<li>两类算法
<ul>
<li>加密算法</li>
<li>摘要算法</li>
</ul></li>
<li>两大组件
<ul>
<li>用于VPN的双方要进行对称密钥的交换的IKE组件</li>
<li>VPN的双方要对连接进行维护的SA（Security Association）组件</li>
</ul></li>
</ul>
<p>IPsec VPN的建立过程</p>
<ol type="1">
<li>第一个阶段，建立IKE自己的SA</li>
<li>建立IPsec SA</li>
</ol>
<p><img src="https://2020.iosdevlog.com/2020/04/13/network/68.jpg" /></p>
<p><img src="https://2020.iosdevlog.com/2020/04/13/network/69.jpg" /></p>
<p><img src="https://2020.iosdevlog.com/2020/04/13/network/70.jpg" /></p>
<p><img src="https://2020.iosdevlog.com/2020/04/13/network/71.jpg" /></p>
<p><img src="https://2020.iosdevlog.com/2020/04/13/network/72.jpg" /></p>
<p><img src="https://2020.iosdevlog.com/2020/04/13/network/73.jpg" /></p>
<p><img src="https://2020.iosdevlog.com/2020/04/13/network/74.jpg" /></p>
<h4 id="比较">比较</h4>
<ul>
<li>IP 协议：
<ul>
<li>不是面向连接的，是尽力而为的协议，每个 IP 包自由选择路径，依赖于上一层 TCP 的重发来保证可靠性</li>
<li>优点：一条道路崩溃时，可以自动换其他路</li>
<li>缺点：不断的路由查找，效率低下</li>
</ul></li>
<li>IPSec VPN 的缺点：
<ul>
<li>由于 IPSec VPN 是基于 IP 协议的，所以速度慢</li>
</ul></li>
<li>ATM 协议：
<ul>
<li>这种协议是面向连接的，并且和 IP 是同一个层次，ATM 是在传输之前先建立一个连接，形成一个虚拟的通路</li>
<li>优点：速度快，因为按照指定路径传输</li>
<li>缺点：当某个节点故障，连接就会中断，无法传输数据</li>
</ul></li>
<li>多协议标签交换「MPLS，Multi-Protocol Label Switching」
<ul>
<li>结合了 IP 和 ATM 协议的优点</li>
<li>需要标签交换路由器「LSR，Label Switching Router」的支持</li>
<li>如何动态生成标签 LDP「Label Distribution Protocol」</li>
</ul></li>
<li>将 MPLS 和 VPN 结合起来可以提高 VPN 的效率
<ul>
<li>需要解决的问题有：
<ul>
<li>BGP 协议如何处理地址空间重叠的 VPN 的路由</li>
<li>路由表怎么区分重复的网段</li>
</ul></li>
</ul></li>
</ul>
<p>IPsec VPN的协议簇</p>
<p>VPN可以将一个机构的多个数据中心通过隧道的方式连接起来，让机构感觉在一个数据中心里面，就像自驾游通过琼州海峡一样；</p>
<p>完全基于软件的 IPsec VPN 可以保证私密性、完整性、真实性、简单便宜，但是性能稍微差一些；</p>
<p>MPLS-VPN 综合和IP转发模式和 ATM 的标签转发模式的优势，性能较好，但是需要从运营商购买。</p>
<h3 id="移动网络">移动网络</h3>
<ul>
<li>2G：txt</li>
<li>3G：jpg</li>
<li>4G：avi</li>
</ul>
<h4 id="g-网络">2G 网络</h4>
<p>手机是通过收发无线信号来通信的，专业名称是 <code>Mobile Station</code>，简称 <code>MS</code>，需要嵌入 <code>SIM</code>。</p>
<p>手机是客户端，而无线信号的服务端，就是基站子系统（BSS，Base Station SubsystemBSS）。</p>
<p>基站子系统分两部分</p>
<ul>
<li>一部分对外提供无线通信，叫作基站收发信台（BTS，Base Transceiver Station）</li>
<li>另一部分对内连接有线网络，叫作基站控制器（BSC，Base Station Controller）</li>
</ul>
<p>基站收发信台通过无线收到数据后，转发给基站控制器。</p>
<p>这部分属于无线的部分，统称为无线接入网（RAN，Radio Access Network）。</p>
<p>基站控制器通过有线网络，连接到提供手机业务的运营商的数据中心，这部分称为核心网（CN，Core Network）。</p>
<p>核心网还没有真的进入互联网，这部分还是主要提供手机业务，是手机业务的有线部分。</p>
<p>首先接待基站来的数据的是移动业务交换中心（MSC，Mobile Service Switching Center），它是进入核心网的入口，但是它不会让你直接连接到互联网上。</p>
<p><img src="https://2020.iosdevlog.com/2020/04/13/network/75.jpg" /></p>
<p>因而2G时代的上网如图所示，我们总结一下，有这几个核心点:</p>
<ul>
<li>手机通过无线信号连接基站;</li>
<li>基站一面朝前接无线，一面朝后接核心网;</li>
<li>核心网一面朝前接到基站请求，一是判断你是否合法，二是判断你是不是本地号，还有没有钱，一面通过网关连接电话网络。</li>
</ul>
<h4 id="g-网络-1">2.5G 网络</h4>
<p>后来从2G到了2.5G，也即在原来电路交换的基础上，加入了分组交换业务，支持Packet的转发，从而支持IP网络。 在上述网络的基础上，基站一面朝前接无线，一面朝后接核心网。在朝后的组件中，多了一个分组控制单元(PCU，Packet Control Unit)，用以提供分组交换通道。 在核心网里面，有个朝前的接待员(SGSN，Service GPRS Supported Node)和朝后连接IP网络的网关型GPRS支持节点(GGSN，Gateway GPRS Supported Node)。</p>
<p><img src="https://2020.iosdevlog.com/2020/04/13/network/76.jpg" /></p>
<h4 id="g-网络-2">3G 网络</h4>
<p>到了3G时代，主要是无线通信技术有了改进，大大增加了无线的带宽。</p>
<p>以W-CDMA为例，理论最高2M的下行速度，因而基站改变了，一面朝外的是Node B，一面朝内连接核心网的是无线网络控制器(RNC，Radio Network Controller)。核心网以及连接的IP网 络没有什么变化。</p>
<p><img src="https://2020.iosdevlog.com/2020/04/13/network/77.jpg" /></p>
<h4 id="g-网络-3">4G 网络</h4>
<p>然后就到了今天的 4G网络，基站为 eNodeB，包含了原来Node B 和 RNC 的功能，下行速度向百兆级别迈进。另外，核心网实现了控制面和数据面的分离，这个怎么理解呢?</p>
<p>在前面的核心网里面，有接待员 MSC 或者 SGSN，你会发现检查是否合法是它负责，转发数据也是它负责，也即控制面和数据面是合二为一的，这样灵活性比较差，因为控制面主要是指令，多是 小包，往往需要高的及时性;数据面主要是流量，多是大包，往往需要吞吐量。</p>
<p>于是有了下面这个架构。</p>
<p><img src="https://2020.iosdevlog.com/2020/04/13/network/78.jpg" /></p>
<p>HSS 用于存储用户签约信息的数据库，其实就是你这个号码归属地是哪里的，以及一些认证信息。</p>
<p>MME 是核心控制网元，是控制面的核心，当手机通过 eNodeB 连上的时候，MME 会根据 HSS 的信息，判断你是否合法。如果允许连上来，MME 不负责具体的数据的流量，而是MME会选择数据 面的 SGW 和 PGW ，然后告诉 eNodeB，我允许你连上来了，你连接它们吧。</p>
<p>于是手机直接通过 eNodeB 连接 SGW ，连上核心网， SGW 相当于数据面的接待员，并通过 PGW 连到 IP网络。 PGW 就是出口网关。在出口网关，有一个组件 PCRF，称为策略和计费控制单元，用 来控制上网策略和流量的计费。</p>
<h4 id="g-网络协议解析">4G 网络协议解析</h4>
<p>我们来仔细看一下4G网络的协议，真的非常复杂。我们将几个关键组件放大来看。</p>
<p><img src="https://2020.iosdevlog.com/2020/04/13/network/79.jpg" /></p>
<h4 id="控制面协议">控制面协议</h4>
<p>其中虚线部分是控制面的协议。当一个手机想上网的时候，先要连接 eNodeB，并通过 S1-MME 接口，请求 MME 对这个手机进行认证和鉴权。</p>
<p>S1-MME 协议栈如下图所示。</p>
<p><img src="https://2020.iosdevlog.com/2020/04/13/network/80.jpg" /></p>
<p>UE就是你的手机，eNodeB还是两面派，朝前对接无线网络，朝后对接核心网络，在控制面对接的是MME。</p>
<p>eNodeB和MME之间的连接就是很正常的IP网络，但是这里面在IP层之上，却既不是TCP，也不是UDP，而是SCTP。这也是传输层的协议，也是面向连接的，但是更加适合移动网络。 它继承了 TCP 较为完善的拥塞控制并改进TCP的一些不足之处。</p>
<ul>
<li>SCTP 的第一个特点是 <code>多宿主</code>。</li>
</ul>
<p>一台机器可以有多个网卡，而对于TCP连接来讲，虽然服务端可以监听0.0.0.0，也就是从哪个网卡来的连接都能接受，但是一旦建立了连接，就建立了四元组，也就选定了某个网卡。</p>
<p>SCTP 引入了联合（association）的概念，将多个接口、多条路径放到一个联合中来。当检测到一条路径失效时，协议就会通过另外一条路径来发送通信数据。应用程序甚至都不必知道发生了故障、恢复，从而提供更高的可用性和可靠性。</p>
<ul>
<li>SCTP 的第二个特点是将一个联合分成多个流。</li>
</ul>
<p>一个联合中的所有流都是独立的，但均与该联合相关。每个流都给定了一个流编号，它被编码到 SCTP 报文中，通过联合在网络上传送。在 TCP 的机制中，由于强制顺序，导致前一个不到达，后一个就得等待，SCTP 的多个流不会相互阻塞。</p>
<ul>
<li>SCTP 的第三个特点是四次握手，防止 SYN 攻击。</li>
</ul>
<p>在TCP中是三次握手，当服务端收到客户的 SYN 之后，返回一个SYN-ACK 之前，就建立数据结构，并记录下状态，等待客户端发送 ACK 的 ACK。当恶意客户端使用虚假的源地址来伪造大量SYN报文时，服务端需要分配大量的资源，最终耗尽资源，无法处理新的请求。</p>
<p>SCTP 可以通过四次握手引入 Cookie 的概念，来有效地防止这种攻击的产生。在 SCTP 中，客户机使用一个INIT报文发起一个连接。服务器使用一个 INIT-ACK 报文进行响应，其中就包括了 Cookie。</p>
<p>然后客户端就使用一个 COOKIE-ECHO 报文进行响应，其中包含了服务器所发送的 Cookie。这个时候，服务器为这个连接分配资源，并通过向客户机发送一个COOKIE-ACK报文对其进行响应。</p>
<ul>
<li>SCTP 的第四个特点是将消息分帧。</li>
</ul>
<p>TCP 是面向流的，也即发送的数据没头没尾，没有明显的界限。这对于发送数据没有问题，但是对于发送一个个消息类型的数据，就不太方便。有可能客户端写入10个字节，然后再写入20个字节。服务端不是读出10个字节的一个消息，再读出20个字节的一个消息，而有可能读入25个字节，再读入5个字节，需要业务层去组合成消息。</p>
<p>SCTP 借鉴了 UDP 的机制，在数据传输中提供了消息分帧功能。当一端对一个套接字执行写操作时，可确保对等端读出的数据大小与此相同。</p>
<ul>
<li>SCTP 的第五个特点是断开连接是三次挥手。</li>
</ul>
<p>在 TCP 里面，断开连接是四次挥手，允许另一端处于半关闭的状态。SCTP 选择放弃这种状态，当一端关闭自己的套接字时，对等的两端全部需要关闭，将来任何一端都不允许再进行数据的移动了。</p>
<p>当MME通过认证鉴权，同意这个手机上网的时候，需要建立一个数据面的数据通路。建立通路的过程还是控制面的事情，因而使用的是控制面的协议 GTP-C。</p>
<p>建设的数据通路分两段路，其实是两个隧道。一段是从 eNodeB 到 SGW ，这个数据通路由 MME 通过 S1-MME 协议告诉 eNodeB，它是隧道的一端，通过 S11 告诉 SGW ，它是隧道的另一端。第二端是从 SGW 到 PGW ， SGW 通过 S11 协议知道自己是其中一端，并主动通过S5协议，告诉 PGW 它是隧道的另一端。</p>
<p>GTP-C 协议是基于 UDP 的，这是 UDP 中的一个例子。如果看GTP头，我们可以看到，这里面有隧道的ID，还有序列号。</p>
<p><img src="https://2020.iosdevlog.com/2020/04/13/network/81.jpg" /></p>
<p>通过序列号，不用TCP，GTP-C自己就可以实现可靠性，为每个输出信令消息分配一个依次递增的序列号，以确保信令消息的按序传递，并便于检测重复包。对于每个输出信令消息启动定时器， 在定时器超时前未接收到响应消息则进行重发。</p>
<h4 id="数据面协议">数据面协议</h4>
<p>当两个隧道都打通，接在一起的时候， PGW 会给手机分配一个 IP地址，这个 IP地址是隧道内部的 IP地址，可以类比为IPsec协议里面的 IP地址。这个IP地址是归手机运营商管理的。然后，手机可 以使用这个 IP地址，连接 eNodeB，从 eNodeB 经过 S1-U协议，通过第一段隧道到达 SGW ，再从 SGW 经过 S8协议，通过第二段隧道到达 PGW ，然后通过 PGW 连接到互联网。</p>
<p>数据面的协议都是通过 GTP-U，如图所示。</p>
<p><img src="https://2020.iosdevlog.com/2020/04/13/network/82.jpg" /></p>
<p>手机每发出的一个包，都由 GTP-U 隧道协议封装起来，格式如下。</p>
<p><img src="https://2020.iosdevlog.com/2020/04/13/network/83.jpg" /></p>
<p>和 IPsec 协议很类似，分为乘客协议、隧道协议、承载协议。其中乘客协议是手机发出来的包，IP 是手机的 IP，隧道协议里面有隧道 ID，不同的手机上线会建立不同的隧道，因而需要隧道ID来标 识。承载协议的 IP 地址是 SGW 和 PGW 的IP地址。</p>
<h4 id="手机上网流程">手机上网流程</h4>
<p>接下来，我们来看一个手机开机之后上网的流程，这个过程称为 Attach。可以看出来，移动网络还是很复杂的。因为这个过程要建立很多的隧道，分配很多的隧道ID，所以我画了一个图来详细 说明这个过程。</p>
<p><img src="https://2020.iosdevlog.com/2020/04/13/network/84.jpg" /></p>
<ol type="1">
<li>手机开机以后，在附近寻找基站eNodeB，找到后给eNodeB发送 Attach Request，说“我来啦，我要上网”。</li>
<li>eNodeB 将请求发给MME，说“有个手机要上网”。</li>
<li>MME 去请求手机，一是认证，二是鉴权，还会请求HSS看看有没有钱，看看是在哪里上网。</li>
<li>当 MME 通过了手机的认证之后，开始分配隧道，先告诉 SGW ，说要创建一个会话(Create Session)。在这里面，会给 SGW 分配一个隧道 ID t1，并且请求 SGW 给自己也分配一个隧道ID。</li>
<li>SGW 转头向 PGW 请求建立一个会话，为 PGW 的控制面分配一个隧道ID t2，也给 PGW 的数据面分配一个隧道ID t3，并且请求 PGW 给自己的控制面和数据面分配隧道ID。</li>
<li>PGW 回复 SGW 说“创建会话成功”，使用自己的控制面隧道ID t2，回复里面携带着给 SGW 控制面分配的隧道ID t4和控制面的隧道 ID t5，至此 SGW 和 PGW 直接的隧道建设完成。双方请求 对方，都要带着对方给自己分配的隧道ID，从而标志是这个手机的请求。</li>
<li>接下来 SGW 回复MME说“创建会话成功”，使用自己的隧道ID t1 访问 MME，回复里面有给MME分配隧道 ID t6，也有 SGW 给 eNodeB 分配的隧道 ID t7。</li>
<li>当MME发现后面的隧道都建设成功之后，就告诉eNodeB，“后面的隧道已经建设完毕， SGW 给你分配的隧道ID是t7，你可以开始连上来了，但是你也要给 SGW 分配一个隧道ID”。</li>
<li>eNodeB 告诉MME自己给 SGW 分配一个隧道，ID为t8。</li>
<li>MME 将 eNodeB 给 SGW 分配的隧道 ID t8 告知 SGW ，从而前面的隧道也建设完毕。</li>
</ol>
<p>这样，手机就可以通过建立的隧道成功上网了。</p>
<h4 id="异地上网问题">异地上网问题</h4>
<p>接下来我们考虑异地上网的事情。 为什么要分 SGW 和 PGW 呢，一个GW不可以吗? SGW 是你本地的运营商的设备，而 PGW 是你所属的运营商的设备。</p>
<p>如果你在巴塞罗那，一下飞机，手机开机，周围搜寻到的肯定是巴塞罗那的eNodeB。通过MME去查寻国内运营商的HSS，看你是否合法，是否还有钱。</p>
<p>如果允许上网，你的手机和巴塞罗那的 SGW 会建立一个隧道，然后巴塞罗那的 SGW 和国内运营商的 PGW 建立一个隧道，然后通过国内运营商的 PGW 上网。</p>
<p><img src="https://2020.iosdevlog.com/2020/04/13/network/85.jpg" /></p>
<p>这样判断你是否能上网的在国内运营商的 HSS，控制你上网策略的是国内运营商的 PCRF，给手机分配的 IP 地址也是国内运营商的 PGW 负责的，给手机分配的IP地址也是国内运营商里统计的。</p>
<p>运营商由于是在 PGW 里面统计的，这样你的上网流量全部通过国内运营商即可，只不过巴塞罗那运营商也要和国内运营商进行流量结算。</p>
<p>由于你的上网策略是由国内运营商在PCRF中控制的，因而你还是上不了脸书。</p>
<ul>
<li>移动网络的发展历程从 2G 到 3G，再到 4G，逐渐从打电话的功能为主，向上网的功能为主转变;</li>
<li>记住 4G网络的结构，有 eNodeB、MME、 SGW 、 PGW 等，分控制面协议和数据面协议，你可以对照着结构，试着说出手机上网的流程;</li>
<li>即便你在国外的运营商下上网，也是要通过国内运营商控制的，因而也上不了脸书。</li>
</ul>
<h2 id="云计算中的网络">云计算中的网络</h2>
<h3 id="云中网络">云中网络</h3>
<h3 id="软件定义网络">软件定义网络</h3>
<h3 id="云中的网络安全">云中的网络安全</h3>
<h3 id="云中的网络qos">云中的网络QoS</h3>
<h3 id="云中网络的隔离grevxlan">云中网络的隔离GRE、VXLAN</h3>
<h2 id="容器技术中的网络">容器技术中的网络</h2>
<h3 id="容器网络">容器网络</h3>
<h3 id="flannel">Flannel</h3>
<h3 id="calico">Calico</h3>
<h2 id="微服务相关协议">微服务相关协议</h2>
<h3 id="rpc协议">RPC协议</h3>
<h3 id="基于-xml-的-soap-协议">基于 XML 的 SOAP 协议</h3>
<h3 id="基于-json-的-restful-接口协议">基于 JSON 的 RESTful 接口协议</h3>
<h3 id="二进制类rpc协议">二进制类RPC协议</h3>
<h3 id="跨语言类rpc协议">跨语言类RPC协议</h3>
<h2 id="搭建一个网络实验环境">搭建一个网络实验环境</h2>
<section class="footnotes" role="doc-endnotes">
<hr />
<ol>
<li id="fn1" role="doc-endnote"><p><a href="https://zh.wikipedia.org/zh-hans/网络传输协议" target="_blank" rel="noopener" class="uri">https://zh.wikipedia.org/zh-hans/网络传输协议</a><a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2" role="doc-endnote"><p><a href="https://time.geekbang.org/column/intro/85" target="_blank" rel="noopener" class="uri">https://time.geekbang.org/column/intro/85</a><a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3" role="doc-endnote"><p><a href="http://cabeggar.github.io/2016/02/21/DHCP-starvation-with-ScaPy/" target="_blank" rel="noopener" class="uri">http://cabeggar.github.io/2016/02/21/DHCP-starvation-with-ScaPy/</a><a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://2020.iosdevlog.com/2020/04/13/network/" data-id="ck9fohbh300c75k2w5mf089so" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/network/" rel="tag">network</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/protocal/" rel="tag">protocal</a></li></ul>

      
        <p><span>作  者:</span><span><a href="https://iosdevlog.com" target="_blank" rel="noopener">iOSDevLog</a></span></p>
        <p><span>许可协议:</span><i class="fa fa-creative-commons"></i> <a rel="license" href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank" title="Attribution-NonCommercial-NoDerivatives 4.0 International (CC BY-NC-ND 4.0)">署名-非商业性使用-禁止演绎 4.0 国际</a> 转载请保留原文链接及作者。</p>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/network/" rel="tag">network</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/protocal/" rel="tag">protocal</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2020/04/15/github/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          GitHub 组织也可以免费创建私有仓库
        
      </div>
    </a>
  
  
    <a href="/2020/04/12/nginx/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">Nginx 思维导图</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/1001/">1001</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/AI/">AI</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/DL/">DL</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/">Python</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Tool/">Tool</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/academy/">academy</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/algorithm/">algorithm</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/book/">book</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/camera/">camera</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/code/">code</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/cs/">cs</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/data/">data</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/dl/">dl</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/docker/">docker</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/editor/">editor</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/game/">game</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/geek/">geek</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/github/">github</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/iOS/">iOS</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/math/">math</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/open-source/">open source</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/party/">party</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/plan/">plan</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/python/">python</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/software/">software</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%86%99%E4%BD%9C/">写作</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%87%86%E5%A4%87/">准备</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%AD%A6%E4%B9%A0/">学习</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%B0%8F%E6%AD%A6/">小武</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%BB%9F%E8%AE%A1%E5%AD%A6%E4%B9%A0%E6%96%B9%E6%B3%95/">统计学习方法</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86/">编译原理</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E8%82%BA%E7%82%8E/">肺炎</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E8%87%AA%E6%88%91%E6%8F%90%E5%8D%87/">自我提升</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E8%A7%86%E8%A7%89%E7%AC%94%E8%AE%B0/">视觉笔记</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E8%AE%A1%E5%88%92/">计划</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E8%AF%BB%E4%B9%A6/">读书</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E8%AF%BB%E4%B9%A6-%E6%94%B9%E9%9D%A9-%E5%A4%A7%E6%B1%9F%E5%A4%A7%E6%B2%B3/">读书 - 改革 - 大江大河</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E8%BF%90%E8%90%A5/">运营</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/3b1b/" rel="tag">3b1b</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/AI/" rel="tag">AI</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ANN/" rel="tag">ANN</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/AR/" rel="tag">AR</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Algebra/" rel="tag">Algebra</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Android/" rel="tag">Android</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/App/" rel="tag">App</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Apple/" rel="tag">Apple</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CV/" rel="tag">CV</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Client/" rel="tag">Client</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Code/" rel="tag">Code</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Compiler/" rel="tag">Compiler</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Construction/" rel="tag">Construction</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Coursera/" rel="tag">Coursera</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/DL/" rel="tag">DL</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/DS/" rel="tag">DS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/DataMining/" rel="tag">DataMining</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Deployment/" rel="tag">Deployment</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/English/" rel="tag">English</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Godot/" rel="tag">Godot</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Google/" rel="tag">Google</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Kindle/" rel="tag">Kindle</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Language/" rel="tag">Language</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Lua/" rel="tag">Lua</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ML/" rel="tag">ML</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Math/" rel="tag">Math</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MediaWiki/" rel="tag">MediaWiki</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/NN/" rel="tag">NN</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/PyTorch/" rel="tag">PyTorch</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Python/" rel="tag">Python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Scene/" rel="tag">Scene</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Swift/" rel="tag">Swift</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/TensorFlow/" rel="tag">TensorFlow</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/UI/" rel="tag">UI</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/VR/" rel="tag">VR</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/action/" rel="tag">action</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/algorithm/" rel="tag">algorithm</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/basic/" rel="tag">basic</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/beginner/" rel="tag">beginner</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/book/" rel="tag">book</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/calculus/" rel="tag">calculus</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cheatsheets/" rel="tag">cheatsheets</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cheeksheet/" rel="tag">cheeksheet</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cmos/" rel="tag">cmos</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/code/" rel="tag">code</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cs/" rel="tag">cs</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cv/" rel="tag">cv</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/data/" rel="tag">data</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/devops/" rel="tag">devops</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/dl/" rel="tag">dl</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/download/" rel="tag">download</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/free/" rel="tag">free</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/geek/" rel="tag">geek</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/geektime/" rel="tag">geektime</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/git/" rel="tag">git</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/github/" rel="tag">github</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hexo/" rel="tag">hexo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/https/" rel="tag">https</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/iOS/" rel="tag">iOS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/icon/" rel="tag">icon</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/infoq/" rel="tag">infoq</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/information/" rel="tag">information</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/java/" rel="tag">java</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jetbrain/" rel="tag">jetbrain</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/js/" rel="tag">js</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/keras/" rel="tag">keras</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/kindle/" rel="tag">kindle</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/kotlin/" rel="tag">kotlin</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linear/" rel="tag">linear</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/lr/" rel="tag">lr</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/manager/" rel="tag">manager</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/manim/" rel="tag">manim</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/matplotlib/" rel="tag">matplotlib</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/microsoft/" rel="tag">microsoft</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mindmap/" rel="tag">mindmap</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ml/" rel="tag">ml</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mobile/" rel="tag">mobile</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/network/" rel="tag">network</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/nginx/" rel="tag">nginx</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/nlp/" rel="tag">nlp</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/nn/" rel="tag">nn</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/numpy/" rel="tag">numpy</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/pandas/" rel="tag">pandas</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/paper/" rel="tag">paper</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/plan/" rel="tag">plan</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/plugin/" rel="tag">plugin</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/pm/" rel="tag">pm</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/pose/" rel="tag">pose</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/protocal/" rel="tag">protocal</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python/" rel="tag">python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/scipy/" rel="tag">scipy</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/search/" rel="tag">search</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/slm/" rel="tag">slm</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/software/" rel="tag">software</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/svm/" rel="tag">svm</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tech/" rel="tag">tech</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/test/" rel="tag">test</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tf/" rel="tag">tf</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tf2/" rel="tag">tf2</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/theory/" rel="tag">theory</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/todo/" rel="tag">todo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tool/" rel="tag">tool</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/visual/" rel="tag">visual</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vscode/" rel="tag">vscode</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/wiki/" rel="tag">wiki</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/year/" rel="tag">year</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%B8%9C%E9%87%8E%E5%9C%AD%E5%90%BE/" rel="tag">东野圭吾</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%B8%AD%E5%9B%BD/" rel="tag">中国</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%BA%BA%E7%89%A9/" rel="tag">人物</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%BC%BD%E5%88%A9%E7%95%A5%E7%B3%BB%E5%88%97/" rel="tag">伽利略系列</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%BD%93%E8%82%B2/" rel="tag">体育</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%81%87%E9%9D%A2%E7%B3%BB%E5%88%97/" rel="tag">假面系列</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%85%8D%E8%B4%B9/" rel="tag">免费</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%85%AC%E4%BC%97%E5%8F%B7/" rel="tag">公众号</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%8A%A0%E8%B4%BA%E6%81%AD%E4%B8%80%E9%83%8E%E7%B3%BB%E5%88%97/" rel="tag">加贺恭一郎系列</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%8F%AF%E8%A7%86%E5%8C%96/" rel="tag">可视化</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%9C%B0%E7%90%83%E7%BC%96%E5%B9%B4%E5%8F%B2/" rel="tag">地球编年史</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%A4%A7%E6%B1%9F%E5%A4%A7%E6%B2%B3/" rel="tag">大江大河</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%A4%A9%E4%B8%8B%E4%B8%80%E5%A4%A7%E4%BA%94%E9%83%8E%E7%B3%BB%E5%88%97/" rel="tag">天下一大五郎系列</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%94%B9%E9%9D%A9/" rel="tag">改革</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%95%88%E7%8E%87/" rel="tag">效率</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%9E%81%E5%AE%A2%E6%97%B6%E9%97%B4/" rel="tag">极客时间</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%83%AD%E7%82%B9/" rel="tag">热点</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%89%88%E6%9D%83/" rel="tag">版权</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%9B%B4%E6%92%AD/" rel="tag">直播</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%A7%BB%E5%8A%A8/" rel="tag">移动</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BB%98%E6%9C%AC/" rel="tag">绘本</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BB%9F%E8%AE%A1%E5%AD%A6%E4%B9%A0%E6%96%B9%E6%B3%95/" rel="tag">统计学习方法</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%A5%BF%E7%90%B4/" rel="tag">西琴</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%AE%BE%E8%AE%A1/" rel="tag">设计</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%AF%BB%E4%B9%A6/" rel="tag">读书</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%94%99%E8%AF%AF/" rel="tag">错误</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/3b1b/" style="font-size: 11.11px;">3b1b</a> <a href="/tags/AI/" style="font-size: 10px;">AI</a> <a href="/tags/ANN/" style="font-size: 11.11px;">ANN</a> <a href="/tags/AR/" style="font-size: 10px;">AR</a> <a href="/tags/Algebra/" style="font-size: 10px;">Algebra</a> <a href="/tags/Android/" style="font-size: 12.22px;">Android</a> <a href="/tags/App/" style="font-size: 10px;">App</a> <a href="/tags/Apple/" style="font-size: 10px;">Apple</a> <a href="/tags/CV/" style="font-size: 13.33px;">CV</a> <a href="/tags/Client/" style="font-size: 10px;">Client</a> <a href="/tags/Code/" style="font-size: 10px;">Code</a> <a href="/tags/Compiler/" style="font-size: 11.11px;">Compiler</a> <a href="/tags/Construction/" style="font-size: 11.11px;">Construction</a> <a href="/tags/Coursera/" style="font-size: 10px;">Coursera</a> <a href="/tags/DL/" style="font-size: 17.78px;">DL</a> <a href="/tags/DS/" style="font-size: 11.11px;">DS</a> <a href="/tags/DataMining/" style="font-size: 10px;">DataMining</a> <a href="/tags/Deployment/" style="font-size: 10px;">Deployment</a> <a href="/tags/English/" style="font-size: 10px;">English</a> <a href="/tags/Godot/" style="font-size: 18.89px;">Godot</a> <a href="/tags/Google/" style="font-size: 10px;">Google</a> <a href="/tags/Kindle/" style="font-size: 10px;">Kindle</a> <a href="/tags/Language/" style="font-size: 10px;">Language</a> <a href="/tags/Lua/" style="font-size: 10px;">Lua</a> <a href="/tags/ML/" style="font-size: 20px;">ML</a> <a href="/tags/Math/" style="font-size: 13.33px;">Math</a> <a href="/tags/MediaWiki/" style="font-size: 11.11px;">MediaWiki</a> <a href="/tags/NN/" style="font-size: 11.11px;">NN</a> <a href="/tags/PyTorch/" style="font-size: 12.22px;">PyTorch</a> <a href="/tags/Python/" style="font-size: 14.44px;">Python</a> <a href="/tags/Scene/" style="font-size: 10px;">Scene</a> <a href="/tags/Swift/" style="font-size: 10px;">Swift</a> <a href="/tags/TensorFlow/" style="font-size: 11.11px;">TensorFlow</a> <a href="/tags/UI/" style="font-size: 10px;">UI</a> <a href="/tags/VR/" style="font-size: 10px;">VR</a> <a href="/tags/action/" style="font-size: 10px;">action</a> <a href="/tags/algorithm/" style="font-size: 17.78px;">algorithm</a> <a href="/tags/basic/" style="font-size: 10px;">basic</a> <a href="/tags/beginner/" style="font-size: 11.11px;">beginner</a> <a href="/tags/book/" style="font-size: 11.11px;">book</a> <a href="/tags/calculus/" style="font-size: 10px;">calculus</a> <a href="/tags/cheatsheets/" style="font-size: 10px;">cheatsheets</a> <a href="/tags/cheeksheet/" style="font-size: 10px;">cheeksheet</a> <a href="/tags/cmos/" style="font-size: 10px;">cmos</a> <a href="/tags/code/" style="font-size: 10px;">code</a> <a href="/tags/cs/" style="font-size: 11.11px;">cs</a> <a href="/tags/cv/" style="font-size: 10px;">cv</a> <a href="/tags/data/" style="font-size: 16.67px;">data</a> <a href="/tags/devops/" style="font-size: 14.44px;">devops</a> <a href="/tags/dl/" style="font-size: 12.22px;">dl</a> <a href="/tags/download/" style="font-size: 10px;">download</a> <a href="/tags/free/" style="font-size: 11.11px;">free</a> <a href="/tags/geek/" style="font-size: 10px;">geek</a> <a href="/tags/geektime/" style="font-size: 10px;">geektime</a> <a href="/tags/git/" style="font-size: 10px;">git</a> <a href="/tags/github/" style="font-size: 10px;">github</a> <a href="/tags/hexo/" style="font-size: 10px;">hexo</a> <a href="/tags/https/" style="font-size: 10px;">https</a> <a href="/tags/iOS/" style="font-size: 15.56px;">iOS</a> <a href="/tags/icon/" style="font-size: 10px;">icon</a> <a href="/tags/infoq/" style="font-size: 10px;">infoq</a> <a href="/tags/information/" style="font-size: 10px;">information</a> <a href="/tags/java/" style="font-size: 10px;">java</a> <a href="/tags/jetbrain/" style="font-size: 10px;">jetbrain</a> <a href="/tags/js/" style="font-size: 10px;">js</a> <a href="/tags/keras/" style="font-size: 10px;">keras</a> <a href="/tags/kindle/" style="font-size: 10px;">kindle</a> <a href="/tags/kotlin/" style="font-size: 10px;">kotlin</a> <a href="/tags/linear/" style="font-size: 10px;">linear</a> <a href="/tags/lr/" style="font-size: 10px;">lr</a> <a href="/tags/manager/" style="font-size: 10px;">manager</a> <a href="/tags/manim/" style="font-size: 14.44px;">manim</a> <a href="/tags/matplotlib/" style="font-size: 10px;">matplotlib</a> <a href="/tags/microsoft/" style="font-size: 10px;">microsoft</a> <a href="/tags/mindmap/" style="font-size: 10px;">mindmap</a> <a href="/tags/ml/" style="font-size: 13.33px;">ml</a> <a href="/tags/mobile/" style="font-size: 10px;">mobile</a> <a href="/tags/network/" style="font-size: 13.33px;">network</a> <a href="/tags/nginx/" style="font-size: 10px;">nginx</a> <a href="/tags/nlp/" style="font-size: 11.11px;">nlp</a> <a href="/tags/nn/" style="font-size: 11.11px;">nn</a> <a href="/tags/numpy/" style="font-size: 10px;">numpy</a> <a href="/tags/pandas/" style="font-size: 10px;">pandas</a> <a href="/tags/paper/" style="font-size: 13.33px;">paper</a> <a href="/tags/plan/" style="font-size: 10px;">plan</a> <a href="/tags/plugin/" style="font-size: 11.11px;">plugin</a> <a href="/tags/pm/" style="font-size: 10px;">pm</a> <a href="/tags/pose/" style="font-size: 10px;">pose</a> <a href="/tags/protocal/" style="font-size: 11.11px;">protocal</a> <a href="/tags/python/" style="font-size: 11.11px;">python</a> <a href="/tags/scipy/" style="font-size: 10px;">scipy</a> <a href="/tags/search/" style="font-size: 10px;">search</a> <a href="/tags/slm/" style="font-size: 10px;">slm</a> <a href="/tags/software/" style="font-size: 10px;">software</a> <a href="/tags/svm/" style="font-size: 10px;">svm</a> <a href="/tags/tech/" style="font-size: 10px;">tech</a> <a href="/tags/test/" style="font-size: 10px;">test</a> <a href="/tags/tf/" style="font-size: 11.11px;">tf</a> <a href="/tags/tf2/" style="font-size: 10px;">tf2</a> <a href="/tags/theory/" style="font-size: 10px;">theory</a> <a href="/tags/todo/" style="font-size: 10px;">todo</a> <a href="/tags/tool/" style="font-size: 10px;">tool</a> <a href="/tags/visual/" style="font-size: 10px;">visual</a> <a href="/tags/vscode/" style="font-size: 11.11px;">vscode</a> <a href="/tags/wiki/" style="font-size: 11.11px;">wiki</a> <a href="/tags/year/" style="font-size: 10px;">year</a> <a href="/tags/%E4%B8%9C%E9%87%8E%E5%9C%AD%E5%90%BE/" style="font-size: 20px;">东野圭吾</a> <a href="/tags/%E4%B8%AD%E5%9B%BD/" style="font-size: 10px;">中国</a> <a href="/tags/%E4%BA%BA%E7%89%A9/" style="font-size: 10px;">人物</a> <a href="/tags/%E4%BC%BD%E5%88%A9%E7%95%A5%E7%B3%BB%E5%88%97/" style="font-size: 10px;">伽利略系列</a> <a href="/tags/%E4%BD%93%E8%82%B2/" style="font-size: 10px;">体育</a> <a href="/tags/%E5%81%87%E9%9D%A2%E7%B3%BB%E5%88%97/" style="font-size: 10px;">假面系列</a> <a href="/tags/%E5%85%8D%E8%B4%B9/" style="font-size: 10px;">免费</a> <a href="/tags/%E5%85%AC%E4%BC%97%E5%8F%B7/" style="font-size: 10px;">公众号</a> <a href="/tags/%E5%8A%A0%E8%B4%BA%E6%81%AD%E4%B8%80%E9%83%8E%E7%B3%BB%E5%88%97/" style="font-size: 13.33px;">加贺恭一郎系列</a> <a href="/tags/%E5%8F%AF%E8%A7%86%E5%8C%96/" style="font-size: 10px;">可视化</a> <a href="/tags/%E5%9C%B0%E7%90%83%E7%BC%96%E5%B9%B4%E5%8F%B2/" style="font-size: 10px;">地球编年史</a> <a href="/tags/%E5%A4%A7%E6%B1%9F%E5%A4%A7%E6%B2%B3/" style="font-size: 10px;">大江大河</a> <a href="/tags/%E5%A4%A9%E4%B8%8B%E4%B8%80%E5%A4%A7%E4%BA%94%E9%83%8E%E7%B3%BB%E5%88%97/" style="font-size: 10px;">天下一大五郎系列</a> <a href="/tags/%E6%94%B9%E9%9D%A9/" style="font-size: 10px;">改革</a> <a href="/tags/%E6%95%88%E7%8E%87/" style="font-size: 10px;">效率</a> <a href="/tags/%E6%9E%81%E5%AE%A2%E6%97%B6%E9%97%B4/" style="font-size: 10px;">极客时间</a> <a href="/tags/%E7%83%AD%E7%82%B9/" style="font-size: 10px;">热点</a> <a href="/tags/%E7%89%88%E6%9D%83/" style="font-size: 10px;">版权</a> <a href="/tags/%E7%9B%B4%E6%92%AD/" style="font-size: 10px;">直播</a> <a href="/tags/%E7%A7%BB%E5%8A%A8/" style="font-size: 10px;">移动</a> <a href="/tags/%E7%BB%98%E6%9C%AC/" style="font-size: 10px;">绘本</a> <a href="/tags/%E7%BB%9F%E8%AE%A1%E5%AD%A6%E4%B9%A0%E6%96%B9%E6%B3%95/" style="font-size: 10px;">统计学习方法</a> <a href="/tags/%E8%A5%BF%E7%90%B4/" style="font-size: 10px;">西琴</a> <a href="/tags/%E8%AE%BE%E8%AE%A1/" style="font-size: 10px;">设计</a> <a href="/tags/%E8%AF%BB%E4%B9%A6/" style="font-size: 11.11px;">读书</a> <a href="/tags/%E9%94%99%E8%AF%AF/" style="font-size: 10px;">错误</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/04/">April 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/03/">March 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/02/">February 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/01/">January 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/12/">December 2019</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2020/04/25/exif/">详解EXIF-数码相机可交换的图像文件格式</a>
          </li>
        
          <li>
            <a href="/2020/04/24/Visual-notes/">《视觉笔记入门课》笔记</a>
          </li>
        
          <li>
            <a href="/2020/04/24/cmos/">数码相机的成像原理</a>
          </li>
        
          <li>
            <a href="/2020/04/23/people/">如何画人</a>
          </li>
        
          <li>
            <a href="/2020/04/22/software-engineering/">话说软件工程</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2020 iOSDevLog<br>
      Powered by © 2020 - <a href="https://www.iosdevlog.com" target="_blank">贾献华 2020 博客</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/2020" class="mobile-nav-link">2020 Calendar</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>




  </div><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</body>
</html>